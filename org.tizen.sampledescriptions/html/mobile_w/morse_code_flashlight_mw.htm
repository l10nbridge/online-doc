<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=9" />
	<link rel="stylesheet" type="text/css" href="../css/styles.css" />
	<link rel="stylesheet" type="text/css" href="../css/snippet.css" />
	<script type="text/javascript" src="../scripts/snippet.js"></script>	
	<script type="text/javascript" src="../scripts/jquery.util.js" charset="utf-8"></script>
	<script type="text/javascript" src="../scripts/common.js" charset="utf-8"></script>
	<script type="text/javascript" src="../scripts/core.js" charset="utf-8"></script>
	<script type="text/javascript" src="../scripts/search.js" charset="utf-8"></script>

	<title>Morse Code Flashlight Sample Overview</title>  
</head>

<body onload="prettyPrint()" style="overflow: auto;">

<div id="toc-navigation">
	<div id="profile">
		<p><img alt="Mobile Web" src="../images/mobile_s_w.png"/></p>
	</div>
	
	<div id="toc_border">
	<div id="toc">
		<p class="toc-title">Related Info</p>
		<ul class="toc">
		   <li><a href="../../../org.tizen.guides/html/web/tizen/system/system_info_w.htm">System Information Guide</a></li> 
		   <li><a href="../../../org.tizen.web.apireference/html/device_api/mobile/tizen/systeminfo.html">System Information API</a></li>  
		</ul>
	</div>
	</div>
</div>	

<div id="container">
<div id="contents">
<div class="content">
  <h1>Morse Code Flashlight Sample Overview</h1> 
  <p>The Morse Code Flashlight sample application demonstrates how you can send messages in Morse code using a flashlight (the camera flash LED diode).</p>
  <p>For information on creating the sample application project in the IDE, see <a href="../cover_page.htm#create">Creating Sample Applications</a>.</p>
  <p>The following figure illustrates the main screen of the Morse Code Flashlight.</p>
  <p class="figure">Figure: Morse Code Flashlight screen</p>
  <p align="center"><img src="../images/morsecodeflashlight.png" alt="Morse Code Flashlight screen"/></p>
<p>The application opens with the main screen, where the user can enter the message text.</p>

<p>To send a message, enter the text to the input field and click <strong>Encode</strong>. The application starts sending the encoded message by flashlight. To switch the flashlight instantly off, click <strong>STOP</strong>.</p>

<h2>Prerequisites</h2>
<ul>
<li>Device must have at least 1 flashlight.</li>
<li>To ensure proper application execution, the following privilege must be set:
<ul><li><span style="font-family: Courier New,Courier,monospace">http://tizen.org/privilege/led</span></li></ul></li>
</ul>
<h2>Source Files</h2> 
<p>You can create and view the sample application project including the source files in the IDE.</p>   
  <table border="1"> 
  <caption>Table: Source files</caption>
   <tbody> 
    <tr> 
     <th>File name</th> 
     <th>Description</th> 
    </tr> 
    <tr> 
     <td><span style="font-family: Courier New,Courier,monospace">config.xml</span></td> 
     <td>This file contains the application information for the platform to install and launch the application, including the view mode and the icon to be used in the device menu.</td> 
    </tr> 
	 <tr> 
     <td><span style="font-family: Courier New,Courier,monospace">ccs/</span></td> 
     <td>This directory contains CSS (Cascading Style Sheets) files used in  the application.</td> 
    </tr> 

    <tr> 
     <td><span style="font-family: Courier New,Courier,monospace">index.html</span></td> 
     <td>This is a starting file from which the application starts loading. It also contains the layout of the application screens.</td> 
    </tr>
	<tr> 
     <td><span style="font-family: Courier New,Courier,monospace">js/</span></td> 
     <td>This directory contains the application code.</td> 
    </tr>	
    <tr>
      <td><span style="font-family: Courier New,Courier,monospace">js/app.js</span></td>
      <td>This file handles the configuration values and initializes the application.</td>
    </tr>
    <tr> 
     <td><span style="font-family: Courier New,Courier,monospace">js/core/</span></td> 
     <td>This directory contains the application framework.</td> 
    </tr> 
    <tr> 
     <td><span style="font-family: Courier New,Courier,monospace">js/models/</span></td> 
     <td>This directory contains the application model modules.</td> 
    </tr> 
    <tr>
      <td><span style="font-family: Courier New,Courier,monospace">js/models/flash.js</span></td>
      <td>This file contains the methods that handle the flashlight data.</td>
    </tr>
    <tr>
      <td><span style="font-family: Courier New,Courier,monospace">js/models/morseTranslator.js</span></td>
      <td>This file contains the method that translates letters into Morse code.</td>
    </tr>
    <tr> 
     <td><span style="font-family: Courier New,Courier,monospace">js/views/</span></td> 
     <td>This directory contains the files implementing the application views.</td> 
    </tr>
    <tr>
      <td><span style="font-family: &quot;Courier New&quot;, Courier, monospace">js/views/main.js</span></td>
      <td>This file contains  the main page UI.</td>
    </tr>
    <tr>
      <td><span style="font-family: Courier New,Courier,monospace">style.css</span></td>
      <td>This file contains the CSS styling for the application UI.</td>
    </tr> 	
   </tbody> 
  </table> 
  
<h2>Implementation</h2>

<h3>Defining the Application Layout</h3>
<p>The application has only 1 screen, which displays a header, an input field, and an <strong>Encode</strong> button:</p>
<pre class="prettyprint">
&lt;!--index.html--&gt;
&lt;header&gt;Morse code flashlight&lt;/header&gt;
&lt;article&gt;
&nbsp;&nbsp;&nbsp;&lt;p&gt;Please insert text for encode to Morse code:&lt;/p&gt;
&nbsp;&nbsp;&nbsp;&lt;input id=&quot;text&quot;/&gt;
&lt;/article&gt;
&lt;footer&gt;
&nbsp;&nbsp;&nbsp;&lt;button id=&quot;start-flashing&quot;&gt;Encode&lt;/button&gt;
&lt;/footer&gt;
</pre>

<h3>Flashing Morse Code</h3>
<p>To flash in Morse code in your application:</p>
<ol>
<li>The application can work only if a flashlight is available in the device. 
<p>When the application starts, the <span style="font-family: Courier New,Courier,monospace">init()</span> method calls the <span style="font-family: Courier New,Courier,monospace">isFlashAvailable()</span> to check the flashlight availability, and initializes the flashlight:</p>
  
<pre class="prettyprint">
/* js/view/main.js */
function init() 
{
&nbsp;&nbsp;&nbsp;if (!flash.isFlashAvailable()) 
&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;window.alert(&#39;Flash light is not supported. Application will be closed.&#39;);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;app.exit();
				
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;
&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;flash.initFlashApi();
 }

/* js/models/flash.js */
function isFlashAvailable() 
{
&nbsp;&nbsp;&nbsp;return tizen.systeminfo.getCapability(&#39;http://tizen.org/feature/camera.back.flash&#39;) 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| tizen.systeminfo.getCapability(&#39;http://tizen.org/feature/camera.front.flash&#39;);
}</pre>
</li>

<li>Initialize the flashlight for use:
<pre class="prettyprint">
/* js.models/flash.js */
function initFlashApi() 
{
&nbsp;&nbsp;&nbsp;tizen.systeminfo.getPropertyValue(&#39;CAMERA_FLASH&#39;, function successCallback(param)
&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;event.fire(&#39;ready&#39;);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flash = param;
&nbsp;&nbsp;&nbsp;},
&nbsp;&nbsp;&nbsp;function failCallback(error) 
&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;event.fire(&#39;error&#39;, error);
&nbsp;&nbsp;&nbsp;});
}</pre>
</li>

<li>To manage the flashlight:
<ul><li>To switch the flashlight on, set the brightness value to the maximum of 1.0:
  <pre class="prettyprint">
/* js/models/flash.js */
function flashOn() 
{
&nbsp;&nbsp;&nbsp;try 
&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flash.setBrightness(1.0);
&nbsp;&nbsp;&nbsp;} 
&nbsp;&nbsp;&nbsp;catch (error) 
&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;window.console.error(error);
&nbsp;&nbsp;&nbsp;}
}
</pre>
</li>

<li>To switch the flashlight off, set the brightness to 0.0:
<pre class="prettyprint">
/* js/models/flash.js */
function flashOff() 
{
&nbsp;&nbsp;&nbsp;try 
&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flash.setBrightness(0.0);
&nbsp;&nbsp;&nbsp;} 
&nbsp;&nbsp;&nbsp;catch (error) 
&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;window.console.error(error);
&nbsp;&nbsp;&nbsp;}
}</pre>
</li></ul></li>

<li>To send signals in Morse code, you must convert the text from the input field into Morse code and pass it to the method that processes it as flashlight signals:
<ul><li><p>The <span style="font-family: Courier New,Courier,monospace">translator.encode()</span> method converts the text from the input field into one of 4 signs in Morse code: DOT, DAH, SHORT_GAP or MEDIUM_GAP.</p></li>
<li><p>The <span style="font-family: Courier New,Courier,monospace">flashCode()</span> method receives the <span style="font-family: Courier New,Courier,monospace">word</span>  parameter, encodes it in Morse code, and changes it into Flashlight signals. The length of each signal is based on the type of signal in the code multiplied by the <span style="font-family: Courier New,Courier,monospace">DIT_LENGTH</span> (base signal display time in milliseconds).</p>
<p>If the first sign in the converted word is a <span style="font-family: Courier New,Courier,monospace">SHORT_GAP</span> or <span style="font-family: Courier New,Courier,monospace">MEDIUM_GAP</span>, the flashlight is switch off; else the flashlight is switched on. The function recursively passes the letters of the <span style="font-family: Courier New,Courier,monospace">word</span> without the first, already converted letter until there are no letters left to pass.</p></li></ul>

<pre class="prettyprint">
/* js/views/main.js */
word = translator.encode(text);
flash.flashCode(word);

/* js/models/flash.js */
var DIT_LENGTH = 200;
function flashCode(word)  
{
&nbsp;&nbsp;&nbsp;var signalLen = 0,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;separatorLen = 0;

&nbsp;&nbsp;&nbsp;if (!word) 
&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;
&nbsp;&nbsp;&nbsp;}

&nbsp;&nbsp;&nbsp;if (word[0] === morse.DOT) 
&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;signalLen = DIT_LENGTH;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;separatorLen = DIT_LENGTH;
&nbsp;&nbsp;&nbsp;} 
&nbsp;&nbsp;&nbsp;else if (word[0] === morse.DAH) 
&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;signalLen = 3 * DIT_LENGTH;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;separatorLen = DIT_LENGTH;
&nbsp;&nbsp;&nbsp;} 
&nbsp;&nbsp;&nbsp;else if (word[0] ===  morse.SHORT_GAP) 
&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;separatorLen = 3 * DIT_LENGTH;
&nbsp;&nbsp;&nbsp;} 
&nbsp;&nbsp;&nbsp;else if (word[0] ===  morse.MEDIUM_GAP) 
&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;separatorLen = 7 * DIT_LENGTH;
&nbsp;&nbsp;&nbsp;}

&nbsp;&nbsp;&nbsp;window.setTimeout(function turnOn() 
&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (word[0] === morse.SHORT_GAP || word[0] === morse.MEDIUM_GAP) 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flashCode(word.slice(1, word.length));

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flashOn();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;window.setTimeout(function turnOff() 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flashOff();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flashCode(word.slice(1, word.length));
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}, signalLen);
&nbsp;&nbsp;&nbsp;}, separatorLen);
}</pre>
</li>
</ol>

<script type="text/javascript" src="../scripts/jquery.zclip.min.js"></script>
<script type="text/javascript" src="../scripts/showhide.js"></script>
</div>
</div>
</div>

<a class="top sms" href="#"><img src="../images/btn_top.gif" alt="Go to top" /></a>

<div id="footer">
<p class="footer">Except as noted, this content - excluding the Code Examples - is licensed under <a href="http://creativecommons.org/licenses/by/3.0/legalcode" target="_blank">Creative Commons Attribution 3.0</a> and all of the Code Examples contained herein are licensed under <a href="https://www.tizen.org/bsd-3-clause-license" target="_blank">BSD-3-Clause</a>.<br/>For details, see the <a href="https://www.tizen.org/content-license" target="_blank">Content License</a>.</p>
</div>

<script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-25976949-1']);
_gaq.push(['_trackPageview']);
(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script>

</body>
</html>
