<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=9" />
	<link rel="stylesheet" type="text/css" href="../css/styles.css" />
	<link rel="stylesheet" type="text/css" href="../css/snippet.css" />
	<script type="text/javascript" src="../scripts/snippet.js"></script>	
	<script type="text/javascript" src="../scripts/jquery.util.js" charset="utf-8"></script>
	<script type="text/javascript" src="../scripts/common.js" charset="utf-8"></script>
	<script type="text/javascript" src="../scripts/core.js" charset="utf-8"></script>
	<script type="text/javascript" src="../scripts/search.js" charset="utf-8"></script>

	<title>SensorBall Sample Overview</title>  
</head>

<body onload="prettyPrint()" style="overflow: auto;">

<div id="toc-navigation">
	<div id="profile">
		<p><img alt="Wearable Web" src="../images/wearable_s_w.png"/></p>
	</div>
	
	<div id="toc_border"><div id="toc">
		<p class="toc-title">Related Info</p>
		<ul class="toc">
		   <li><a href="../../../org.tizen.guides/html/web/tizen/system/sensor_w.htm">Sensor Guide</a></li> 
		   <li><a href="../../../org.tizen.web.apireference/html/device_api/wearable/tizen/sensor.html">Sensor API</a></li>		   
		</ul>
	</div></div>
</div>	

<div id="container"><div id="contents"><div class="content">
  <h1>SensorBall Sample Overview</h1> 
  <p>The SensorBall sample application demonstrates how you can create an application that simulates behavior of a ball in three different environments.</p>
  <p>The user can impact the movement of the ball by moving the device. The application reads acceleration of the device and changes the position of the ball to simulate inertia and gravity forces.</p> 
<p>For information on creating the sample application project in the IDE, see <a href="../cover_page.htm#create">Creating Sample Applications</a>.</p> 
 <p>The following figure illustrates the main screen of the SensorBall.</p> 
  <p class="figure">Figure: SensorBall screen</p> 
  <p align="center"><img alt="SensorBall screen" src="../images/sensorball_ww.png" /> </p> 

  
   <p>The main page of the application contains the scene and three buttons at the bottom. The buttons allow switching between the following environments: gravity, sky, and space.</p>
  <ul>
  <li><p>The gravity environment simulates a ball in indoor conditions. The movement of the ball is affected by gravity. The screenshot on the left presents the scene with this environment.</p></li>
  <li><p>The sky environment simulates a balloon in the sky. The balloon is filled with gas lighter than air, so it slowly moves up. The screenshot in the middle presents the scene.</p></li>
  <li><p>The space environment simulates a planet in space. Sun and Earth are placed on the scene and Earth orbits the sun as shown in the screenshot on the right. In this environment the gravity does not depend on acceleration of the device. Instead, positions of the Sun and the background are slightly changed in response to the device movement.</p>
  </li>
  </ul>


  <h2>Source Files</h2> 
  <p>You can create and view the sample application project including the source files in the IDE.</p> 
  <table border="1"> 
   <tbody> 
    <tr> 
     <th>File name</th> 
     <th>Description</th> 
    </tr> 
    <tr> 
     <td><span style="font-family: Courier New,Courier,monospace">config.xml</span></td> 
     <td>This file contains the application information for the platform to install and launch the application, including the view mode and the icon to be used in the device menu.</td> 
    </tr> 
	<tr>
    <td><span style="font-family: Courier New,Courier,monospace">css/</span></td>
    <td>This directory contains the CSS styling for the application UI.</td>
  </tr>
    <tr> 
     <td><span style="font-family: Courier New,Courier,monospace">images/</span></td> 
     <td>This directory contains the images used to create the user interface.</td> 
    </tr>   
    <tr> 
     <td><span style="font-family: Courier New,Courier,monospace">index.html</span></td> 
     <td>This is a starting file from which the application starts loading. It contains the layout of the application screens.</td> 
    </tr> 
	 <tr> 
     <td><span style="font-family: Courier New,Courier,monospace">js/app.js</span></td> 
     <td>This file defines the initialization module.</td> 
    </tr> 
    <tr> 
     <td><span style="font-family: Courier New,Courier,monospace">js/core/</span></td> 
     <td>This file contains the application framework.</td> 
    </tr> 
    <tr> 
     <td><span style="font-family: Courier New,Courier,monospace">js/models/ball.js</span></td> 
     <td>This file is the model of the ball. It contains the ball position and speed.</td> 
    </tr> 	
    <tr> 
     <td><span style="font-family: Courier New,Courier,monospace">js/models/gravity.js</span></td> 
     <td>This file is the model of the gravity. It performs calculations for the ball in the gravity mode.</td> 
    </tr>
    <tr> 
     <td><span style="font-family: Courier New,Courier,monospace">js/models/space.js</span></td> 
     <td>This file is the model of space. It performs calculations for the planet in space.</td> 
    </tr>
    <tr> 
     <td><span style="font-family: Courier New,Courier,monospace">js/models/rectangular.js</span></td> 
     <td>This file is the model of the rectangular scene. It calculates the collisions between the ball and the scene edges.</td> 
    </tr>
    <tr> 
     <td><span style="font-family: Courier New,Courier,monospace">js/models/circular.js</span></td> 
     <td>This is the model of a circular scene. It calculates the collisions between the ball and the scene edge.</td> 
    </tr>
    <tr> 
     <td><span style="font-family: Courier New,Courier,monospace">js/views/</span></td> 
     <td>This directory contains the code to render the elements of the scene and handles the UI events.</td> 
    </tr>	
   </tbody> 
  </table> 
  
<h2>Implementation</h2>
<p>The following functions demonstrate adding the <span style="font-family: Courier New,Courier,monospace">devicemotion</span> event listener and handling the event. </p>

<pre class="prettyprint">
/* views/main.js */
function onDeviceMotion(event) 
{
&nbsp;&nbsp;&nbsp;ball.setMotionData(event);
}

function bindEvents() 
{
&nbsp;&nbsp;&nbsp;var gravityButton = document.getElementById(GRAVITY_BUTTON_ID),
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;skyButton = document.getElementById(SKY_BUTTON_ID),
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spaceButton = document.getElementById(SPACE_BUTTON_ID);

&nbsp;&nbsp;&nbsp;window.addEventListener(&#39;tizenhwkey&#39;, onHardwareKeysTap);

&nbsp;&nbsp;&nbsp;/* devicemotion event listener */
&nbsp;&nbsp;&nbsp;window.addEventListener(&#39;devicemotion&#39;, onDeviceMotion);

&nbsp;&nbsp;&nbsp;document.addEventListener(&#39;webkitvisibilitychange&#39;, onVisibilityChange);

&nbsp;&nbsp;&nbsp;gravityButton.addEventListener(&#39;click&#39;, function onBallTap() 
&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;startGravity();
&nbsp;&nbsp;&nbsp;});

&nbsp;&nbsp;&nbsp;skyButton.addEventListener(&#39;click&#39;, function onSkyTap() 
&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;startSky();
&nbsp;&nbsp;&nbsp;});

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; startSpace();
});
</pre>

<p>The following function sets the motion data with the given event value.</p>
 <pre class="prettyprint">
/* models/ball.js */
function setMotionData(event) 
{
&nbsp;&nbsp;&nbsp; motionData = event;
}
</pre>

<p>The following function calculates the ball&#39;s velocity based on the sensor motion data.</p>
<pre class="prettyprint">
/* models/gravity.js */
function calculateVelocity() 
{
&nbsp;&nbsp;&nbsp;var x = 0,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y = 0,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ddx = 0,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ddy = 0;

&nbsp;&nbsp;&nbsp;if (motionData !== null) 
&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x = -motionData.accelerationIncludingGravity.x;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y = -motionData.accelerationIncludingGravity.y;
&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;ddx = x * -cdd;
&nbsp;&nbsp;&nbsp;ddy = y * cdd;
&nbsp;&nbsp;&nbsp;v.x += ddx;
&nbsp;&nbsp;&nbsp;v.y += ddy;
&nbsp;&nbsp;&nbsp;v.x *= friction;
&nbsp;&nbsp;&nbsp;v.y *= friction;
}
</pre>
<p>The following  function calculates the position of the Sun in the space mode based on the data received from the motion sensor.</p> 
<pre class="prettyprint">
/* models/space.js */
function getSunPosition() 
{
&nbsp;&nbsp;&nbsp;var result = {},

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x = -motionData.accelerationIncludingGravity.x,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y = -motionData.accelerationIncludingGravity.y,

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rX = -8.0,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rY = -8.0,

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cX = (gameWidth - sunWidth) / 2,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cY = (gameHeight - sunHeight) / 2,

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tX = cX + (-x * rX),
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tY = cY + (y * rY),

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bdX = tX - sunX,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bdY = tY - sunY,

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;br = 0.2;

&nbsp;&nbsp;&nbsp;sunX += bdX * br;
&nbsp;&nbsp;&nbsp;sunY += bdY * br;

&nbsp;&nbsp;&nbsp;result.x = sunX;
&nbsp;&nbsp;&nbsp;result.y = sunY;

&nbsp;&nbsp;&nbsp;return result;
}
</pre>
 
<p>The following  function calculates the position of the background in the space mode based on the data received from the motion sensor.</p> 
<pre class="prettyprint">
/* models/space.js */
function getBackgroundPosition() 
{
&nbsp;&nbsp;&nbsp;var result = {},

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x = -motionData.accelerationIncludingGravity.x,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y = -motionData.accelerationIncludingGravity.y,

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rX = -30.0,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rY = -30.0,

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cX = (gameWidth - backgroundWidth) / 2,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cY = (gameHeight - backgroundHeight) / 2,

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tX = cX + (-x * rX),
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tY = cY + (y * rY),

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bdX = tX - backgroundLeft,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bdY = tY - backgroundTop,

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;br = 0.2;

&nbsp;&nbsp;&nbsp;backgroundLeft += bdX * br;
&nbsp;&nbsp;&nbsp;backgroundTop += bdY * br;

&nbsp;&nbsp;&nbsp;result.left = backgroundLeft;
&nbsp;&nbsp;&nbsp;result.top = backgroundTop;

&nbsp;&nbsp;&nbsp;return result;
}
</pre>
  
<script type="text/javascript" src="../scripts/jquery.zclip.min.js"></script>
<script type="text/javascript" src="../scripts/showhide.js"></script>
</div></div></div>

<a class="top sms" href="#"><img src="../images/btn_top.gif" alt="Go to top" /></a>

<div id="footer">
<p class="footer">Except as noted, this content - excluding the Code Examples - is licensed under <a href="http://creativecommons.org/licenses/by/3.0/legalcode" target="_blank">Creative Commons Attribution 3.0</a> and all of the Code Examples contained herein are licensed under <a href="https://www.tizen.org/bsd-3-clause-license" target="_blank">BSD-3-Clause</a>.<br/>For details, see the <a href="https://www.tizen.org/content-license" target="_blank">Content License</a>.</p>
</div>

<script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-25976949-1']);
_gaq.push(['_trackPageview']);
(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script>

</body>
</html>
