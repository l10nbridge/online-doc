<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=9" />
	<link rel="stylesheet" type="text/css" href="../css/styles.css" />
	<link rel="stylesheet" type="text/css" href="../css/snippet.css" />
	<script type="text/javascript" src="../scripts/snippet.js"></script>	
	<script type="text/javascript" src="../scripts/jquery.util.js" charset="utf-8"></script>
	<script type="text/javascript" src="../scripts/common.js" charset="utf-8"></script>
	<script type="text/javascript" src="../scripts/core.js" charset="utf-8"></script>
	<script type="text/javascript" src="../scripts/search.js" charset="utf-8"></script>

	<title>WorldClock Sample Overview</title>  
</head>

<body onload="prettyPrint()" style="overflow: auto;">

<div id="toc-navigation">
	<div id="profile">
		<p><img alt="Wearable Web" src="../images/ww_icon.png"/></p>
	</div>
	
	<div id="toc_border"><div id="toc">
		<p class="toc-title">Related Info</p>
		<ul class="toc">
			<li><a href="../../../org.tizen.guides/html/web/w3c/graphics/canvas_w.htm">HTML5 Canvas Guide</a></li>  
			<li><a href="../../../org.tizen.web.apireference/html/w3c_api/w3c_api_w.html#canvas">HTML5 Canvas Element API</a></li>
			<li><a href="../../../org.tizen.web.apireference/html/w3c_api/w3c_api_w.html#canvas2d">HTML Canvas 2D Context API</a></li>
			<li><a href="../../../org.tizen.web.apireference/html/w3c_api/w3c_api_w.html#webstorage">Web Storage API</a></li>
			<li><a href="../../../org.tizen.web.apireference/html/device_api/wearable/tizen/time.html">Time API</a></li>		   
		</ul>
	</div></div>
</div>	

<div id="container"><div id="contents"><div class="content">
  <h1>WorldClock Sample Overview</h1> 
   <p>The WorldClock sample application demonstrates how you can create a world clock using the Time and Web Storage APIs.</p> 
<p>For information on creating the sample application project in the IDE, see <a href="../cover_page.htm#create">Creating Sample Applications</a>.</p>   
<p>The following figure illustrates the main screens of the WorldClock.</p> 
  <p class="figure">Figure: WorldClock screens</p> 
  <p align="center"><img alt="WorldClock screens" src="../images/worldclock_sd.png" /> </p>
 <p>The application opens with a main screen that shows the current local time with a world map on the background.</p>

 <p>To select the cities whose time is displayed, two-finger tap the main screen. In the Emulator, press the <strong>CTRL</strong> key and click twice on the Emulator screen. </p>
 
  <p>The selected cities are indicated with colored marks on the map and correspondingly colored hour hands. The data for the selected cities is stored in the Web storage, so that the same settings can be applied when the application restarts.</p>
  
  <h2 id="source" name="source">Source Files</h2> 
  <p>You can create and view the sample application project including the source files in the IDE.</p> 
  <table border="1"> 
   <tbody> 
    <tr> 
     <th>File name</th> 
     <th>Description</th> 
    </tr> 
    <tr> 
     <td><span style="font-family: Courier New,Courier,monospace">config.xml</span></td> 
     <td>This file contains the application information for the platform to install and launch the application, including the view mode and the icon to be used in the device menu.</td> 
    </tr> 
  <tr>
    <td><span style="font-family: Courier New,Courier,monospace">css/style.css</span></td>
    <td>This file contains the CSS styling for the application UI.</td>
  </tr>
    <tr> 
     <td><span style="font-family: Courier New,Courier,monospace">index.html</span></td> 
     <td>This is a starting file from which the application starts loading. It contains the layout of the application screens.</td> 
    </tr> 
  <tr>
     <td><span style="font-family: Courier New,Courier,monospace">js/data.js</span></td>
     <td>This file contains the data array of the location and time zone information of the available countries.</td>
    </tr>	
  <tr>
	<td><span style="font-family: Courier New,Courier,monospace">js/main.js</span></td>
	<td>This file contains the code for handling the main functionalities of the application.</td>
	</tr>
   </tbody> 
  </table> 
  

<h2>Implementation</h2>
<p>The <span style="font-family: Courier New,Courier,monospace">setSize()</span> function dynamically calculates and sets the size and margin of the canvas according to the screen size of different devices.</p>
<pre class="prettyprint">
function setSize() 
{
&nbsp;&nbsp;&nbsp;var pageWatch = document.getElementById(&#39;pageWatch&#39;),
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;divTable = document.getElementById(&#39;selectTable&#39;);

&nbsp;&nbsp;&nbsp;pageWatch.style.width = document.body.clientWidth + &#39;px&#39;;
&nbsp;&nbsp;&nbsp;pageWatch.style.height = document.body.clientHeight + &#39;px&#39;;
&nbsp;&nbsp;&nbsp;divTable.style.paddingTop = ((document.body.clientHeight / 2) - (TABLE_HEIGHT / 2)) + &#39;px&#39;;
}</pre>
 
<p>The <span style="font-family: Courier New,Courier,monospace">drawWatch()</span> function draws the layout and the content of the WorldClock.</p>
 <p>The <span style="font-family: Courier New,Courier,monospace">getCurrentDateTime()</span> function of the <a href="../../../org.tizen.web.apireference/html/device_api/wearable/tizen/time.html">Time</a> API returns the time data of the current local time. The <span style="font-family: Courier New,Courier,monospace">toTimezone(tzid)</span> function returns the time data converted to a given time zone.</p>
  <pre class="prettyprint">
function drawWatch() 
{
&nbsp;&nbsp;&nbsp;var i = 0,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;date = tizen.time.getCurrentDateTime(),
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hour = date.getHours(),
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minute = date.getMinutes(),
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;second = date.getSeconds();

&nbsp;&nbsp;&nbsp;/* Draw the layout of the clock, including the world map on the background */
&nbsp;&nbsp;&nbsp;drawWatchLayout();

&nbsp;&nbsp;&nbsp;/* Draw the minute hand and the hour hand of the current time of the user&#39;s default city */
&nbsp;&nbsp;&nbsp;drawWatchContentDefault(hour, minute, second, 0, 0);

&nbsp;&nbsp;&nbsp;/* Draw the colored hour hands for corresponding cities */
&nbsp;&nbsp;&nbsp;for (i = 0; i &lt; colorCity.length; i++) 
&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (cityArray[colorCity[i].cityId].tzid !== &#39;NONE&#39;) 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hour = tizen.time.getCurrentDateTime().toTimezone(cityArray[colorCity[i].cityId].tzid).getHours();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;drawWatchContentCity(hour, minute, colorCity[i].colorCode,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cityArray[colorCity[i].cityId].mapX * (document.body.clientWidth / 360),
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cityArray[colorCity[i].cityId].mapY * (document.body.clientWidth / 360));
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;}
}
</pre>
<p>To ensure that the hands of the clock move with the time, the <span style="font-family: Courier New,Courier,monospace">drawWatch()</span> function is called repeatedly every 500 milliseconds as defined in the <span style="font-family: Courier New,Courier,monospace">setInterval()</span> function.</p>
<pre class="prettyprint">
setInterval(function() {drawWatch();}, 500);
</pre>
<p>The event listener with the <span style="font-family: Courier New,Courier,monospace">&#39;touchstart&#39;</span> event determines the number of touch points the user places. When a two-finger tap event is received, the page for the city selection is displayed.</p>
<pre class="prettyprint">
document.getElementById(&#39;myCanvas&#39;).addEventListener(&#39;touchstart&#39;, function(ev) 
{
&nbsp;&nbsp;&nbsp;touch = ev.touches[0] || ev.changedTouches[0];
&nbsp;&nbsp;&nbsp;touchList = ev.touches;

&nbsp;&nbsp;&nbsp;if (touchList.length === 2) 
&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;displayCity();
&nbsp;&nbsp;&nbsp;}
});
</pre>
<p>The <span style="font-family: Courier New,Courier,monospace">localStorage</span> object stores the data for the selected cities. This way the data is not lost when the application is terminated, and it is available again when the application restarts.</p>
<pre class="prettyprint">
document.getElementById(&#39;btnSave&#39;).addEventListener(&#39;click&#39;, function() 
{
&nbsp;&nbsp;&nbsp;for (i = 0; i &lt; colorCity.length; i++) 
&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;localStorage.setItem(colorCity[i].colorCode, colorCity[i].cityId);
&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;displayWatch();
&nbsp;&nbsp;&nbsp;drawWatch();
});
</pre>
  
<script type="text/javascript" src="../scripts/jquery.zclip.min.js"></script>
<script type="text/javascript" src="../scripts/showhide.js"></script>
</div></div></div>

<a class="top sms" href="#"><img src="../images/btn_top.gif" alt="Go to top" /></a>

<div id="footer">
<p class="footer">Except as noted, this content - excluding the Code Examples - is licensed under <a href="http://creativecommons.org/licenses/by/3.0/legalcode" target="_blank">Creative Commons Attribution 3.0</a> and all of the Code Examples contained herein are licensed under <a href="https://www.tizen.org/bsd-3-clause-license" target="_blank">BSD-3-Clause</a>.<br/>For details, see the <a href="https://www.tizen.org/content-license" target="_blank">Content License</a>.</p>
</div>

<script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-25976949-1']);
_gaq.push(['_trackPageview']);
(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script>

</body>
</html>