<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
	<meta http-equiv="X-UA-Compatible" content="IE=9" />
	<link rel="stylesheet" type="text/css" href="../../css/styles.css" />
	<link rel="stylesheet" type="text/css" href="../../css/snippet.css" />
	<script type="text/javascript" src="../../scripts/snippet.js"></script>	
	<script type="text/javascript" src="../../scripts/jquery.util.js" charset="utf-8"></script>
	<script type="text/javascript" src="../../scripts/common.js" charset="utf-8"></script>
	<script type="text/javascript" src="../../scripts/core.js" charset="utf-8"></script>
	<script type="text/javascript" src="../../scripts/search.js" charset="utf-8"></script>
  <title>Widget Application</title> 
 </head> 
 <body onload="prettyPrint()" style="overflow: auto;">
 
 <div id="toc-navigation">
	<div id="profile">
		<p><img alt="Mobile native" src="../../images/mobile_s_n.png"/> <img alt="Wearable native" src="../../images/wearable_s_n.png"/></p>
	</div>
	
	<div id="toc_border"><div id="toc">
		<p class="toc-title">Content</p>
			<ul class="toc">
				<li><a href="#app_instance">Widget Application and Widget Instance</a></li>
				<li><a href="#app">Widget Application States and Events</a></li>
				<li><a href="#instance">Widget Instance States and Events</a></li>
				<li><a href="#share">Data Sharing Between the Widget Application and Other Applications</a></li>
			</ul>
		<p class="toc-title">Related Info</p>
		<ul class="toc">
			<li><a href="../../../../org.tizen.tutorials/html/native/app_framework/widget_tutorial_n.htm">Widget Application Tutorial</a></li>
			<li><a href="../../../../org.tizen.native.mobile.apireference/group__CAPI__WIDGET__APP__MODULE.html">Widget Application API for Mobile Native</a></li>
			<li><a href="../../../../org.tizen.native.wearable.apireference/group__CAPI__WIDGET__APP__MODULE.html">Widget Application API for Wearable Native</a></li>

			</ul>
	</div></div>
</div>

<div id="container"><div id="contents"><div class="content">

<h1>Widget Application</h1>
<p>You can <a href="../../../../org.tizen.tutorials/html/native/app_framework/widget_tutorial_n.htm#init">create widget applications</a>, which are Tizen native applications shown on the home screen. They are launched by the home screen when the user selects them in the <strong>Add Widget</strong> menu.</p>

  <p>The main features of the Widget Application API include:</p>
  <ul>
	<li>Managing multiple widget instances
	<p>Each widget application usually has 1 process for maintaining the main loop. Within that process, the application can <a href="../../../../org.tizen.tutorials/html/native/app_framework/widget_tutorial_n.htm#get_instance">create multiple widget instances</a> that can share the same resources.</p></li>
	<li>Managing the life-cycle
	<p>You can manage the widget application and widget instance life-cycles through callbacks that are triggered as the application or instance state changes.</p>
	<p>The widget application starts with the <span style="font-family: Courier New,Courier,monospace">main()</span> function, which <a href="../../../../org.tizen.tutorials/html/native/app_framework/widget_tutorial_n.htm#create">creates and initializes the application</a>. The <span style="font-family: Courier New,Courier,monospace">widget_app_main()</span> function is used to start the application event loop. Before calling this function, set up the <span style="font-family: Courier New,Courier,monospace">widget_app_lifecycle_callback_s</span> structure variable, which is passed to the function.</p>
	<p>To ensure that the application runs smoothly, you must <a href="../../../../org.tizen.devtools/html/native_tools/manifest_text_editor_n.htm#widget_app">edit the application manifest file</a> to define the widget settings.</p>
	</li>
	<li>Creating the widget UI
	<p>The widget application can <a href="../../../../org.tizen.tutorials/html/native/app_framework/widget_tutorial_n.htm#get_window">draw a UI on the home screen</a>. To do this, you must get the window object of the home screen and attach UI components to it. You can use the <span style="font-family: Courier New,Courier,monospace">widget_app_get_elm_win()</span> function to create an EFL object for widget window.</p>
	  <table class="note"> 
   <tbody> 
    <tr> 
     <th class="note">Note</th> 
    </tr> 
    <tr> 
     <td class="note">The widget application UI has a limitation with the scroll action to provide better user experience. Design the widget UI to display all the information within the given area of the screen points.</td> 
    </tr> 
   </tbody> 
  </table> 
	
	</li>
	</ul>

<h2 id="app_instance" name="app_instance">Widget Application and Widget Instance</h2>

<p>The widget application provides a life-cycle and methods for making and managing a widget class. It consists of 1 process and make the widget class in the <span style="font-family: Courier New,Courier,monospace">widget_app_create()</span> callback function. With this class, the framework can make instances whenever applications for widget viewers, such as home screen and lock screen, request for a widget instance.</p>
<p>The widget instance has its own life-cycle similar to the widget application. However, the widget instance is only an object shown by the applications for widget viewers. Many widget instances can be running on the same widget application process.</p>
<p class="figure">Figure: Each widget application has 1 or more widget instances</p>
<p align="center"><img alt="Each widget application has 1 or more widget instances" src="../../images/widget_homescreen.png"/></p>


<h2 id="app" name="app">Widget Application States and Events</h2>

<p>The following figure illustrates the widget application states during the application life-cycle:</p>
<ul>
<li>When the application is launched, it is in the Ready state.</li>
<li>When the application is running on the background, it is in the Running state.</li>
<li>When the application exits, it is in the Terminated state.</li>
</ul>
       <p class="figure">Figure: Widget application life-cycle</p>
       <p align="center"><img alt="Widget application life-cycle" src="../../images/widget_app_lifecycle.png" /></p>


<p>The following table lists the callbacks you can use as the application state changes.</p>

<table>
	   <caption>
			   Table: Application state change callbacks
	   </caption>
	   <tbody>
	  <tr>
			   <th>Callback</th>
			   <th>Description</th>
	   </tr>
	   <tr>
			   <td><span style="font-family: Courier New,Courier,monospace">widget_app_create_cb()</span></td>
			   <td>Called before the main loop of the application starts.</td>
	   </tr>
	   <tr>
			   <td><span style="font-family: Courier New,Courier,monospace">widget_app_terminate_cb()</span></td>
			   <td>Called after the main loop of the application exits.</td>
	   </tr>
	   </tbody>
</table>
	
<h2 id="instance" name="instance">Widget Instance States and Events</h2>

<p>The following figure illustrates the widget instance states during the instance life-cycle:</p>
<ul>
<li>When the application is in the Ready state, the instance does not exist.</li>
<li>When the instance is created, it is in the Created state.</li>
<li>When the instance is visible, it is in the Running state.</li>
<li>When the instance is invisible, it is in the Paused state.</li>
<li>When the instance is destroyed, it is in the Destroyed state.</li>
</ul>
       <p class="figure">Figure: Widget instance life-cycle</p>
       <p align="center"><img alt="Widget instance life-cycle" src="../../images/widget_instance_lifecycle.png" /></p>


<p>The following table lists the <a href="../../../../org.tizen.tutorials/html/native/app_framework/widget_tutorial_n.htm#life-cycle">callbacks you can use as the instance state changes</a>.</p>

<table>
	   <caption>
			   Table: Instance state change callbacks
	   </caption>
	   <tbody>
	  <tr>
			   <th>Callback</th>
			   <th>Description</th>
	   </tr>
	   <tr>
			   <td><span style="font-family: Courier New,Courier,monospace">widget_instance_create_cb()</span></td>
			   <td>Called after the widget instance is created.</td>
	   </tr>
	   <tr>
			   <td><span style="font-family: Courier New,Courier,monospace">widget_instance_destroy_cb()</span></td>
			   <td>Called before the widget instance is destroyed.</td>
	   </tr>

	   <tr>
			   <td><span style="font-family: Courier New,Courier,monospace">widget_instance_pause_cb()</span></td>
			   <td>Called when the widget is invisible.</td>
	   </tr>
	   <tr>
			   <td><span style="font-family: Courier New,Courier,monospace">widget_instance_resume_cb()</span></td>
			   <td>Called when the widget is visible.</td>
	   </tr>

	   <tr>
			   <td><span style="font-family: Courier New,Courier,monospace">widget_instance_resize_cb()</span></td>
			   <td>Called before the widget size is changed.</td>
	   </tr>

	   <tr>
			   <td><span style="font-family: Courier New,Courier,monospace">widget_instance_update_cb()</span></td>
			   <td>Called when an event for updating the widget is received.</td>
	   </tr>
	   </tbody>
</table>	
	
<p>To register widget instance callbacks, use the <span style="font-family: Courier New,Courier,monospace">widget_app_class_create()</span> function within the <span style="font-family: Courier New,Courier,monospace">widget_app_create_cb()</span> callback function:</p>	

<pre class="prettyprint">
static widget_class_h
widget_app_create(void *user_data)
{
&nbsp;&nbsp;&nbsp;widget_instance_lifecycle_callback_s ops = 
&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.create = widget_instance_create,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.destroy = widget_instance_destroy,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.pause = widget_instance_pause,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.resume = widget_instance_resume,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.update = widget_instance_update,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.resize = widget_instance_resize,
&nbsp;&nbsp;&nbsp;};

&nbsp;&nbsp;&nbsp;return widget_app_class_create(ops, user_data);
}
</pre>

<p>When the widget launch is requested for the first time, the widget application is initialized and the widget instance is created only after the initialization. If there are additional launch requests for the same widget, a new widget instance for those is created directly, since the widget application has already been initialized.</p>

<p class="figure">Figure: Launching widget instances</p>
<p align="center"><img alt="Launching widget instances" src="../../images/widget_app_instance_flow.png"/></p>

<h2 id="share" name="share">Data Sharing Between the Widget Application and Other Applications</h2>

<p>You can share data between widget applications and UI (or service) applications. However, you must understand that this kind of data sharing is based on the file system. The reason is that the system (Home screen) controls the widget application life-cycle, while the UI application life-cycle is mostly explicitly controlled by the user.</p>

<p>For example, consider the differences between a Weather application and a Weather widget:</p>
<ul>
<li>The Weather application is launched when user selects it from the application list.</li>
<li>The widget is launched when the Home screen is on screen and is terminated when the Home screen is hidden.</li></ul>

<p>Although the widget wants to share some data from the Weather application (such as the user&#39;s favorite city), it is ineffective for the widget to launch the Weather application every time to retrieve such data. This inefficiency makes it difficult to use typical IPC mechanisms, such as socket and <a href="message_port_n.htm">Message Port</a>, in which both the receiver and sender processes must be alive for communication. To overcome this issue, the widget application must use a communication type where the data is permanently stored somewhere in the system.</p> 

<p>In the Tizen platform, applications in the same package (including widget applications) can access files in the <span style="font-family: Courier New,Courier,monospace">data</span> directory of the package installation path. This means that the UI (or service) application can first write files to the <span style="font-family: Courier New,Courier,monospace">data</span> directory, and the widget can later read them, or vice versa.</p>

<p class="figure">Figure: Sharing through the data directory</p> 
<p align="center"><img alt="Sharing through the data directory" src="../../images/widget_data_share.png" /></p> 

<p>To manage data through the <span style="font-family: Courier New,Courier,monospace">data</span> directory:</p>

<ul>
<li><p>You can set and get data in the <span style="font-family: Courier New,Courier,monospace">data</span> directory using the Preference API functions (in <a href="../../../../org.tizen.native.mobile.apireference/group__CAPI__PREFERENCE__MODULE.html">mobile</a> and <a href="../../../../org.tizen.native.wearable.apireference/group__CAPI__PREFERENCE__MODULE.html">wearable</a> applications). You can use the functions to <a href="../../../../org.tizen.tutorials/html/native/app_framework/preference_tutorial_n.htm">store and retrieve key-value data</a> in the <span style="font-family: Courier New,Courier,monospace">data</span> directory.</p></li>

<li><p>You can share the <span style="font-family: Courier New,Courier,monospace">data</span> directory content with Sqlite, by creating an Sqlite database file in the <span style="font-family: Courier New,Courier,monospace">data</span> directory.</p>
<p>The Sqlite database has an advantage to a direct use of a file in error handling, such as journaling. Consequently, if the application must handle complex data rather than primitive values, <a href="../../../../org.tizen.tutorials/html/native/base/sqlite_tutorial_n.htm">use Sqlite to store and retrieve the data</a>.</p></li></ul>

<p>If an application requires complex control over a widget, such as Music Player, it must implement a service application in the middle and use the Data Control API (in <a href="../../../../org.tizen.native.mobile.apireference/group__CAPI__DATA__CONTROL__MODULE.html">mobile</a> and <a href="../../../../org.tizen.native.wearable.apireference/group__CAPI__DATA__CONTROL__MODULE.html">wearable</a> applications).</p>
<p>For example, a music-player-service service application is needed to control the audio device, process audio files, and handle play and stop signals. The music-player-ui and music-player-widget applications display the UI controls, title, album arts, and other content retrieved from the music-player-service service application. The service application can export its data using the Data Control to <a href="data_control_n.htm">provide data to the other applications</a> (widget and UI) simultaneously.</p>

<p>The following figure illustrates typical data control flows between the set of UI, service, and widget applications.</p>

<p class="figure">Figure: Sharing through data control</p> 
<p align="center"><img alt="Sharing through data control" src="../../images/widget_data_control_share.png" /></p>

<table class="note">
  <tbody>
    <tr>
     <th class="note">Note</th>
    </tr>
    <tr>
     <td class="note">For user convenience, a STANDALONE widget application package is not allowed in the Tizen Store.
	 <p>You can make a STANDALONE widget application in the IDE for test purposes. However, to publish it, you must combine it with at least 1 UI application in the package. For more details, see <a href="../../../../org.tizen.gettingstarted/html/native/process/app_dev_process_n.htm#develop">Developing Multiple Projects as a Combined Package</a>.</p></td>
    </tr>
  </tbody>
</table>


<script type="text/javascript" src="../../scripts/jquery.zclip.min.js"></script>
<script type="text/javascript" src="../../scripts/showhide.js"></script>
</div></div></div>

<a class="top sms" href="#"><img src="../../images/btn_top.gif" alt="Go to top" /></a>

<div id="footer">
<p class="footer">Except as noted, this content - excluding the Code Examples - is licensed under <a href="http://creativecommons.org/licenses/by/3.0/legalcode" target="_blank">Creative Commons Attribution 3.0</a> and all of the Code Examples contained herein are licensed under <a href="https://www.tizen.org/bsd-3-clause-license" target="_blank">BSD-3-Clause</a>.<br/>For details, see the <a href="https://www.tizen.org/content-license" target="_blank">Content License</a>.</p>
</div>

<script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-25976949-1']);
_gaq.push(['_trackPageview']);
(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script>

</body>
</html>	