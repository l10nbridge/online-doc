<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
	<meta http-equiv="X-UA-Compatible" content="IE=9" />
	<link rel="stylesheet" type="text/css" href="../../css/styles.css" />
	<link rel="stylesheet" type="text/css" href="../../css/snippet.css" />
	<script type="text/javascript" src="../../scripts/snippet.js"></script>
	<script type="text/javascript" src="../../scripts/jquery.util.js" charset="utf-8"></script>
	<script type="text/javascript" src="../../scripts/common.js" charset="utf-8"></script>
	<script type="text/javascript" src="../../scripts/core.js" charset="utf-8"></script>
	<script type="text/javascript" src="../../scripts/search.js" charset="utf-8"></script>
	<title>Contextual Trigger</title>
</head>
<body onload="prettyPrint()" style="overflow: auto;">

<div id="navigation">
	<div id="profile">
		<p><img alt="Mobile native" src="../../images/mn_icon.png"/></p>
	</div>

	<div id="toc_border"><div id="toc">
		<p class="toc-title">Content</p>
		<ul class="toc">
			<li><a href="#rule_structure">Structure of Rules</a></li>
			<li><a href="#event_and_condition">Event and Conditions</a></li>
			<li><a href="#action">Actions</a></li>
		</ul>
		<p class="toc-title">Related Info</p>
		<ul class="toc">
			<li><a href="../../../../org.tizen.tutorials/html/native/context/trigger_tutorial_n.htm">Contextual Trigger Tutorial</a></li>
			<li><a href="../../../../org.tizen.native.mobile.apireference/group__CAPI__CONTEXT__TRIGGER__MODULE.html">Contextual Trigger API</a></li>
		</ul>
	</div></div>
</div>

<div id="container"><div id="contents"><div class="content">

<h1>Contextual Trigger</h1>

<p>
The <a href="../../../../org.tizen.native.mobile.apireference/group__CAPI__CONTEXT__TRIGGER__MODULE.html">Contextual Trigger</a>
API enables you to work with rules in your applications,by creating, managing and removing rules.
</p>
<p>
Your application can define a rule as a combination of a contextual event, conditions, and an action.
If the rule is enabled, the system starts to monitor device status or user activities corresponding to the event defined in the rule.
When the event is detected, the conditions will be evaluated, each of which is related a contextual state of the device or the user.
Lastly, if the conditions are satisfied, the action is triggered.
The action can be an application launching request via the <a href="../app/application_n.htm#app_controls">App Control</a> or a notification posting
via the <a href="../app/notification_n.htm">Notification</a>.
For example, every 10:00 PM, if battery level is low, you application may able to post a notification like 'Charge your battery please'.
</p>
<p class="figure">Figure: Rule States</p>
<p style="text-align:center;"><img alt="Rule States" src="../../images/context_trigger_rule_states.png" /></p>
<p>
The rest of this guide is organized as follows.
First, the basic <a href="#rule_structure">structure of rules</a> are explained.
Then, the main two components for triggering decisions, <a href="#event_and_condition">events and conditions</a> are described in details.
Lastly, the <a href="#action">action</a> component of rules are explained.
</p>


<h2 id="rule_structure" name="rule_structure">Structure of Rules</h2>

<p>
An application first needs to assemble a rule, which consist of the three main components: event, condition, and action.
The figure below illustrates the rule components and their relations.
</p>
<p class="figure">Figure: Components of Rules</p>
<p style="text-align:center;"><img alt="Rule Components" src="../../images/context_trigger_rule_components.png" width="350"/></p>
<p>
An <em>event</em> literally denotes a contextual event that can be recognized in the device,
or a change of a certain contextual state of the device or the user.
For example, connections of peripherals, changes of settings, locational changes, or specific times can be used as events.
Note that, only one event should be defined in a rule, as it is used as the initiator of the verification of the conditions.
If the system detects the occurrence of the designated event, it is started to verify the conditions.
</p>
<p>
A <em>condition</em> denotes a contextual state or fact that can be recognized in the device.
For example, current device status or historical pattern of the device usages can be used as conditions.
In a rule, the application can define one condition, multiple conditions, or even no condition.
If defining multiple conditions in a rule, the application can choose the way of combining the conditions,
<i>i.e.</i>, logical conjunction or disjunction.
In case of the logical conjunction, the rule is true only if all the conditions are satisfied.
Otherwise, the rule can be true if at least one condition is satisfied.
If no condition is given in a rule, the rule will be satisfied instantly if the corresponding event occurs.
</p>
<p>
Finally, an <em>action</em>, which will be triggered if the rule is satisfied, needs to be specified.
Similar to the case of events, a rule should contain one action.
As the action itself can be defined as an <a href="../app/application_n.htm#app_controls">App Control</a>,
if necessary, you can implement an application that executes a series of tasks to create a complex context-aware service.
</p>
<p>
Once a rule is composed and registered successfully into the system, a unique rule ID is assigned to the rule.
Then the rule can be activated using the rule ID. The rule can also be disabled or permanently removed from the system by using the rule ID.
Note that, however, only the application that registered a rule can enable, disable, or remove the rule.
</p>
<table class="note">
	<tbody>
		<tr>
			<th class="note">Note</th>
		</tr>
		<tr>
			<td class="note">
				A rule can be enabled, disabled, or removed by the owner application, which composed and registered the rule.
			</td>
		</tr>
	</tbody>
</table>
<p>
For convenience, an application can retrieve the lists of the active and inactive rule IDs, each of which is owned by the application.
</p>
<p>
As a special case, if you only need to monitor a fundamental system event, <i>e.g.</i>, USB connection status,
to launch a service application, and no condition is required, it is recommended to use the <a href="../app/app_guide_n.htm">Event System</a>.
In such cases, using the event system instead of the contextual trigger would be more efficient,
as the contextual trigger runs a rule engine to manage state changes of multiple event and condition items simultaneously.
</p>
<table class="note">
	<tbody>
		<tr>
			<th class="note">Note</th>
		</tr>
		<tr>
			<td class="note">
				If you want to launch a service application whenever a fundamental system event occurs,
				without any further condition checking,
				it is recommend to use the <a href="../app/app_guide_n.htm">Event System</a>,
				instead of this contextual trigger.
			</td>
		</tr>
	</tbody>
</table>


<h2 id="event_and_condition" name="event_and_condition">Event and Conditions</h2>

<p>
In a rule, the combination of an event and conditions formulates the logical statement that decides to (or not to) execute the action of the rule.
Events and conditions are defined on various kinds of contextual information, which can be recognized on the device.
An event represents a contextual state change or a contextual event literally, such as "a headphone is plugged", "the battery level is dropped to low",
or "the user enters his home". A condition represents a current contextual state or a device or user profile inferred through the usage history,
for example, "the current battery level is low", "Wi-Fi connection is active", or
"(when receiving an incoming call) the number is the most frequent address in his call logs".
</p>
<p>
Defining an event or a condition may involve attribute comparisons, and input option parameter settings in some cases.
The below example illustrates how to formulate a simple rule of "at 10 PM, if the battery is not charging".
The action part will be described later.
</p>
<p>
First, a rule handle needs to be created.
The first parameter <span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_LOGICAL_CONJUNCTION</span>
denotes how to combine all condition entries, but let's skip this now, for simplicity.
</p>
<pre class="prettyprint">
// Creating a rule handle
context_trigger_rule_h rule = NULL;
context_trigger_rule_create(CONTEXT_TRIGGER_LOGICAL_CONJUNCTION, &rule);
</pre>

<p>
Then in the below code, an event "at 10 PM every day" is defined.
A <span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_EVENT_ON_TIME</span> type event entry is created,
and a key-value comparison of "<span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_TIME_OF_DAY</span> == 22"
is set to the event.
</p>
<pre class="prettyprint">
// Composing an event
context_trigger_rule_entry_h event = NULL;
context_trigger_rule_event_create(CONTEXT_TRIGGER_EVENT_ON_TIME, CONTEXT_TRIGGER_LOGICAL_CONJUNCTION, &event);
context_trigger_rule_entry_add_key(event, CONTEXT_TRIGGER_LOGICAL_CONJUNCTION, CONTEXT_TRIGGER_TIME_OF_DAY);
context_trigger_rule_entry_add_comparison_int(event, CONTEXT_TRIGGER_TIME_OF_DAY, CONTEXT_TRIGGER_EQUAL_TO, 22);

// Adding the event to the rule and releasing the resource occupied.
context_trigger_rule_add_entry(rule, event);
context_trigger_rule_entry_destroy(event);
</pre>

<p>
Lastly, the condition statement of "battery is not charging" is formulated and added to the rule handle.
In the condition entry of <span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_CONDITION_BATTERY</span>,
the comparison statement is defined as the equality check <span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_EQUAL_TO</span>
between the left operand <span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_IS_CHARGING</span>
and the right operand <span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_FALSE</span>.
</p>
<pre class="prettyprint">
// Composing a condition
context_trigger_rule_entry_h condition = NULL;
context_trigger_rule_condition_create(CONTEXT_TRIGGER_CONDITION_BATTERY, CONTEXT_TRIGGER_LOGICAL_CONJUNCTION, &condition);
context_trigger_rule_entry_add_key(condition, CONTEXT_TRIGGER_LOGICAL_CONJUNCTION, CONTEXT_TRIGGER_IS_CHARGING);
context_trigger_rule_entry_add_comparison_int(condition, CONTEXT_TRIGGER_IS_CHARGING, CONTEXT_TRIGGER_EQUAL_TO, CONTEXT_TRIGGER_FALSE);

// Adding the condition to the handle
context_trigger_rule_add_entry(rule, condition);
context_trigger_rule_entry_destroy(condition);
</pre>

<p>
The above example rule only contains one condition, and both the event and the condition contain one key-value comparison for each.
More complex rules, with multiple conditions and multiple comparisons in the event and each condition, can be formulated.
Furthermore, certain events and conditions require to set option parameters. Such advanced cases will be discussed later.
Before discussing such cases, available comparison keys for events and conditions are introduced.
</p>


<h3>Comparison Attributes for Events and Conditions</h3>

<p>
The table below summarizes the corresponding comparison attribute keys, with respect to the even and condition items,
and the valid right operands for each attribute key.
See also <a href="../../../../org.tizen.native.mobile.apireference/group__CAPI__CONTEXT__TRIGGER__MODULE.html">the API reference</a>
to find out the necessary privilege for each item.
</p>

<table>
	<caption>Table: Attribute Keys and the Corresponding Operands</caption>
	<tbody>
		<tr>
			<th>Event/Condition</th>
			<th>Attribute Key</th>
			<th>Type</th>
			<th>Valid Operands</th>
		</tr>
		<tr>
			<td rowspan="2"><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_EVENT_ON_TIME</span></td>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_TIME_OF_DAY</span></td>
			<td>Integer</td>
			<td>From 0 to 23(hour)</td>
		</tr>
		<tr>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_DAY_OF_WEEK</span></td>
			<td>String</td>
			<td><span style="font-family: Courier New,Courier,monospace">
				CONTEXT_TRIGGER_MON, CONTEXT_TRIGGER_TUE, CONTEXT_TRIGGER_WED, CONTEXT_TRIGGER_THU, CONTEXT_TRIGGER_FRI,
				CONTEXT_TRIGGER_SAT, CONTEXT_TRIGGER_SUN, CONTEXT_TRIGGER_WEEKDAY, CONTEXT_TRIGGER_WEEKEND
			</span></td>
		</tr>
		<tr>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_CONDITION_TIME_OF_DAY</span></td>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_TIME_OF_DAY</span></td>
			<td>Integer</td>
			<td>From 0 to 1439 (minute)</td>
		</tr>
		<tr>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_CONDITION_DAY_OF_WEEK</span></td>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_DAY_OF_WEEK</span></td>
			<td>String</td>
			<td><span style="font-family: Courier New,Courier,monospace">
				CONTEXT_TRIGGER_MON, CONTEXT_TRIGGER_TUE, CONTEXT_TRIGGER_WED, CONTEXT_TRIGGER_THU, CONTEXT_TRIGGER_FRI,
				CONTEXT_TRIGGER_SAT, CONTEXT_TRIGGER_SUN, CONTEXT_TRIGGER_WEEKDAY, CONTEXT_TRIGGER_WEEKEND
			</span></td>
		</tr>
		<tr>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_CONDITION_TIME_OF_MONTH</span></td>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_DAY_OF_MONTH</span></td>
			<td>Integer</td>
			<td>From 1 to 31</td>
		</tr>
		<tr>
			<td><span style="font-family: Courier New,Courier,monospace">
				CONTEXT_TRIGGER_EVENT_CHARGER<br>
				CONTEXT_TRIGGER_EVENT_USB<br>
				CONTEXT_TRIGGER_CONDITION_CHARGER<br>
				CONTEXT_TRIGGER_CONDITION_USB
			</span></td>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_IS_CONNECTED</span></td>
			<td>Integer</td>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_TRUE, CONTEXT_TRIGGER_FALSE</span></td>
		</tr>
		<tr>
			<td rowspan="2"><span style="font-family: Courier New,Courier,monospace">
				CONTEXT_TRIGGER_EVENT_BATTERY<br>
				CONTEXT_TRIGGER_CONDITION_BATTERY
			</span></td>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_LEVEL</span></td>
			<td>String</td>
			<td><span style="font-family: Courier New,Courier,monospace">
				CONTEXT_TRIGGER_EMPTY, CONTEXT_TRIGGER_CRITICAL, CONTEXT_TRIGGER_LOW, CONTEXT_TRIGGER_NORMAL, CONTEXT_TRIGGER_HIGH, CONTEXT_TRIGGER_FULL
			</span></td>
		</tr>
		<tr>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_IS_CHARGING</span></td>
			<td>Integer</td>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_TRUE, CONTEXT_TRIGGER_FALSE</span></td>
		</tr>
		<tr>
			<td><span style="font-family: Courier New,Courier,monospace">
				CONTEXT_TRIGGER_EVENT_FLIGHT_MODE<br>
				CONTEXT_TRIGGER_EVENT_POWER_SAVING_MODE<br>
				CONTEXT_TRIGGER_EVENT_SILENT_MODE<br>
				CONTEXT_TRIGGER_EVENT_VIBRATION_MODE<br>
				CONTEXT_TRIGGER_CONDITION_FLIGHT_MODE<br>
				CONTEXT_TRIGGER_CONDITION_POWER_SAVING_MODE<br>
				CONTEXT_TRIGGER_CONDITION_SILENT_MODE<br>
				CONTEXT_TRIGGER_CONDITION_VIBRATION_MODE
			</span></td>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_IS_ENABLED</span></td>
			<td>Integer</td>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_TRUE, CONTEXT_TRIGGER_FALSE</span></td>
		</tr>
		<tr>
			<td><span style="font-family: Courier New,Courier,monospace">
				CONTEXT_TRIGGER_EVENT_GPS<br>
				CONTEXT_TRIGGER_CONDITION_GPS
			</span></td>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_STATE</span></td>
			<td>String</td>
			<td><span style="font-family: Courier New,Courier,monospace">
				CONTEXT_TRIGGER_DISABLED, CONTEXT_TRIGGER_SEARCHING, CONTEXT_TRIGGER_CONNECTED
			</span></td>
		</tr>
		<tr>
			<td rowspan="2"><span style="font-family: Courier New,Courier,monospace">
				CONTEXT_TRIGGER_EVENT_HEADPHONE<br>
				CONTEXT_TRIGGER_CONDITION_HEADPHONE
			</span></td>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_IS_CONNECTED</span></td>
			<td>Integer</td>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_TRUE, CONTEXT_TRIGGER_FALSE</span></td>
		</tr>
		<tr>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_TYPE</span></td>
			<td>String</td>
			<td><span style="font-family: Courier New,Courier,monospace">
				CONTEXT_TRIGGER_NORMAL, CONTEXT_TRIGGER_HEADSET, CONTEXT_TRIGGER_BLUETOOTH
			</span></td>
		</tr>
		<tr>
			<td rowspan="2"><span style="font-family: Courier New,Courier,monospace">
				CONTEXT_TRIGGER_EVENT_WIFI<br>
				CONTEXT_TRIGGER_CONDITION_WIFI
			</span></td>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_STATE</span></td>
			<td>String</td>
			<td><span style="font-family: Courier New,Courier,monospace">
				CONTEXT_TRIGGER_DISABLED, CONTEXT_TRIGGER_CONNECTED, CONTEXT_TRIGGER_UNCONNECTED
			</span></td>
		</tr>
		<tr>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_BSSID</span></td>
			<td>String</td>
			<td>WiFi BSSID</span></td>
		</tr>
		<tr>
			<td rowspan="3"><span style="font-family: Courier New,Courier,monospace">
				CONTEXT_TRIGGER_EVENT_CALL<br>
				CONTEXT_TRIGGER_CONDITION_CALL
			</span></td>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_STATE</span></td>
			<td>String</td>
			<td><span style="font-family: Courier New,Courier,monospace">
				CONTEXT_TRIGGER_IDLE, CONTEXT_TRIGGER_CONNECTING, CONTEXT_TRIGGER_CONNECTED
			</span></td>
		</tr>
		<tr>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_MEDIUM</span></td>
			<td>String</td>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_VOICE, CONTEXT_TRIGGER_VIDEO</span></td>
		</tr>
		<tr>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_ADDRESS</span></td>
			<td>String</td>
			<td>Phone number</td>
		</tr>
		<tr>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_EVENT_EMAIL</span></td>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_EVENT</span></td>
			<td>String</td>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_RECEIVED, CONTEXT_TRIGGER_SENT</span></td>
		</tr>
		<tr>
			<td rowspan="2"><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_EVENT_MESSAGE</span></td>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_EVENT</span></td>
			<td>String</td>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_RECEIVED</span></td>
		</tr>
		<tr>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_TYPE</span></td>
			<td>String</td>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_SMS, CONTEXT_TRIGGER_MMS</span></td>
		</tr>
		<tr>
			<td rowspan="2"><span style="font-family: Courier New,Courier,monospace">
				CONTEXT_TRIGGER_EVENT_ACTIVITY_STATIONARY<br>
				CONTEXT_TRIGGER_EVENT_ACTIVITY_WALKING<br>
				CONTEXT_TRIGGER_EVENT_ACTIVITY_RUNNING<br>
				CONTEXT_TRIGGER_EVENT_ACTIVITY_IN_VEHICLE
			</span></td>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_EVENT</span></td>
			<td>String</td>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_DETECTED</span></td>
		</tr>
		<tr>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_ACCURACY</span></td>
			<td>String</td>
			<td><span style="font-family: Courier New,Courier,monospace">
				CONTEXT_TRIGGER_HIGH, CONTEXT_TRIGGER_NORMAL, CONTEXT_TRIGGER_LOW
			</span></td>
		</tr>
		<tr>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_EVENT_PLACE</span></td>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_EVENT</span></td>
			<td>String</td>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_IN, CONTEXT_TRIGGER_OUT</span></td>
		</tr>
		<tr>
			<td rowspan="4"><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_CONDITION_APP_USE_FREQUENCY</span></td>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_APP_ID</span></td>
			<td>String</td>
			<td>Application ID</td>
		</tr>
		<tr>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_RANK</span></td>
			<td>Integer</td>
			<td>Positive integer</td>
		</tr>
		<tr>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_TOTAL_COUNT</span></td>
			<td>Integer</td>
			<td>Nonnegative integer</td>
		</tr>
		<tr>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_AVERAGE_COUNT</span></td>
			<td>Integer</td>
			<td>Nonnegative integer</td>
		</tr>
		<tr>
			<td rowspan="4"><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_CONDITION_COMMUNICATION_FREQUENCY</span></td>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_APP_ADDRESS</span></td>
			<td>String</td>
			<td>Phone number</td>
		</tr>
		<tr>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_RANK</span></td>
			<td>Integer</td>
			<td>Positive integer</td>
		</tr>
		<tr>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_TOTAL_COUNT</span></td>
			<td>Integer</td>
			<td>Nonnegative integer</td>
		</tr>
		<tr>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_AVERAGE_COUNT</span></td>
			<td>Integer</td>
			<td>Nonnegative integer</td>
		</tr>
		<tr>
			<td rowspan="2"><span style="font-family: Courier New,Courier,monospace">
				CONTEXT_TRIGGER_CONDITION_MUSIC_PLAYBACK_FREQUENCY<br>
				CONTEXT_TRIGGER_CONDITION_VIDEO_PLAYBACK_FREQUENCY
			</span></td>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_TOTAL_COUNT</span></td>
			<td>Integer</td>
			<td>Nonnegative integer</td>
		</tr>
		<tr>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_AVERAGE_COUNT</span></td>
			<td>Integer</td>
			<td>Nonnegative integer</td>
		</tr>
	</tbody>
</table>

<h3>Operators for Attribute Comparisons</h3>

<p>
Regarding data types of attributes, as comparison operators, the followings are allowed:
</p>

<ul>
	<li>For integer type attributes
		<ul>
			<li><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_EQUAL_TO</span>
			<li><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_NOT_EQUAL_TO</span>
			<li><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_GREATER_THAN</span>
			<li><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_GREATER_THAN_OR_EQUAL_TO</span>
			<li><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_LESS_THAN</span>
			<li><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_LESS_THAN_OR_EQUAL_TO</span>
		</ul>
	</li>
	<li>For string type attributes
		<ul>
			<li><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_EQUAL_TO</span>
			<li><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_NOT_EQUAL_TO</span>
		</ul>
	</li>
</ul>


<h3>Options</h3>

<p>
Certain events or conditions require to specify some option values to clarify its monitoring or computation objective.
For example, if an event is defined using <span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_EVENT_PLACE</span>,
the detection target place should be specified, by the place ID that can be retrieved via the
<a href="../location/location_guide_n.htm#">Geofence Manager</a>, as in the following example.
</p>

<pre class="prettyprint">
// Getting the target place ID via the Geofence Manager API
int place_id;

// See the <a href="../location/location_guide_n.htm#">Geofence Manager</a> to know how to get the proper place ID.

// Composing an event "when the user enters his home"
context_trigger_rule_entry_h event = NULL;
context_trigger_rule_event_create(CONTEXT_TRIGGER_EVENT_PLACE, CONTEXT_TRIGGER_LOGICAL_CONJUNCTION, &event);
context_trigger_rule_entry_add_option_int(event, CONTEXT_TRIGGER_PLACE_ID, place_id);

// ...
</pre>

<p>
As another use case, it is also possible to use an attribute value of the event as an option (or a right operand of a comparison) in a condition.
As an example, the logical statement "when receiving a message, if the sender's number is the most frequently communicated number"
can be formulated as follows.
</p>
<pre class="prettyprint">
// Composing an event "when receiving a message"
context_trigger_rule_entry_h event = NULL;
context_trigger_rule_event_create(CONTEXT_TRIGGER_EVENT_MESSAGE, CONTEXT_TRIGGER_LOGICAL_CONJUNCTION, &event);
context_trigger_rule_entry_add_key(event, CONTEXT_TRIGGER_LOGICAL_CONJUNCTION, CONTEXT_TRIGGER_EVENT);
context_trigger_rule_entry_add_comparison_string(event, CONTEXT_TRIGGER_EVENT, CONTEXT_TRIGGER_EQUAL_TO, CONTEXT_TRIGGER_RECEIVED);

// Composing a condition "if the sender's number is the most frequently communicated number"
context_trigger_rule_entry_h condition = NULL;
context_trigger_rule_condition_create(CONTEXT_TRIGGER_CONDITION_COMMUNICATION_FREQUENCY, CONTEXT_TRIGGER_LOGICAL_CONJUNCTION, &condition);

// The message sender's address is used as an option of the condition.
context_trigger_rule_entry_add_option(condition, CONTEXT_TRIGGER_ADDRESS, CONTEXT_TRIGGER_ADDRESS);

// Checking if the frequency rank of the address is equal to 1
context_trigger_rule_entry_add_key(condition, CONTEXT_TRIGGER_LOGICAL_CONJUNCTION, CONTEXT_TRIGGER_RANK);
context_trigger_rule_entry_add_comparison_int(condition, CONTEXT_TRIGGER_RANK, CONTEXT_TRIGGER_EQUAL_TO, 1);
</pre>

<p>
Available options keys and the corresponding values are summarized in the table below.
</p>

<table>
	<caption>Table: Options Keys and the Corresponding Values</caption>
	<tbody>
		<tr>
			<th>Event/Condition</th>
			<th>Option Key</th>
			<th>Type</th>
			<th>Valid Value</th>
		</tr>
		<tr>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_EVENT_PLACE</span></td>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_PLACE_ID</span></td>
			<td>Integer</td>
			<td>
				Place ID.
				See <a href="../location/location_guide_n.htm">Geofence Manager</a> for more details.
			</td>
		</tr>
		<tr>
			<td rowspan="2"><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_CONDITION_APP_USE_FREQUENCY</span></td>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_APP_ID</span></td>
			<td>String</td>
			<td>Application ID</td>
		</tr>
		<tr>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_RANK</span></td>
			<td>Integer</td>
			<td>Positive integer</td>
		</tr>
		<tr>
			<td rowspan="2"><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_CONDITION_COMMUNICATION_FREQUENCY</span></td>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_ADDRESS</span></td>
			<td>String</td>
			<td>Phone number</td>
		</tr>
		<tr>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_RANK</span></td>
			<td>Integer</td>
			<td>Positive integer</td>
		</tr>
		<tr>
			<td rowspan="4"><span style="font-family: Courier New,Courier,monospace">
				CONTEXT_TRIGGER_CONDITION_APP_USE_FREQUENCY<br>
				CONTEXT_TRIGGER_CONDITION_COMMUNICATION_FREQUENCY<br>
				CONTEXT_TRIGGER_CONDITION_MUSIC_PLAYBACK_FREQUENCY<br>
				CONTEXT_TRIGGER_CONDITION_VIDEO_PLAYBACK_FREQUENCY
			</span></td>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_TIME_OF_DAY</span></td>
			<td>String</td>
			<td>Time interval of day. For example, "13-15" denotes "from 1 PM to 3 PM".</td>
		</tr>
		<tr>
			<td><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_DAY_OF_WEEK</span></td>
			<td>String</td>
			<td><span style="font-family: Courier New,Courier,monospace">
				CONTEXT_TRIGGER_MON, CONTEXT_TRIGGER_TUE, CONTEXT_TRIGGER_WED, CONTEXT_TRIGGER_THU, CONTEXT_TRIGGER_FRI,
				CONTEXT_TRIGGER_SAT, CONTEXT_TRIGGER_SUN, CONTEXT_TRIGGER_WEEKDAY, CONTEXT_TRIGGER_WEEKEND
			</span></td>
		</tr>
	</tbody>
</table>


<h3>Logical Conjunction and Disjunctions</h3>

<p>
A rule may contain multiple conditions. Some event/condition items provide more than one attribute keys.
For one attribute, more than one comparison statements also can be defined, for example, the value of an attribute is equal to A, B, or C.
To combine multiple comparisons into an attribute, multiple attributes into an event or a condition, and multiple conditions into a rule,
the contextual trigger allows to choose one of the following logical operators:
</p>

<ul>
	<li><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_LOGICAL_CONJUNCTION</span>:<br>
		It denotes logical "AND". As usual, it means that "true if and only if all components are true".
	</li>
	<li><span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_LOGICAL_DISJUNCTION</span>:<br>
		It denotes logical "OR". As usual, it means that "true if at least one component is true".
	</li>
</ul>

<h4>Combining Conditions into a Rule</h4>

<p>
With the logical conjunction operator, the rule evaluation becomes true if all the conditions are satisfied.
On the other hand, with the logical disjunction operator, the rule evaluation becomes true if at least one of the conditions is satisfied.
If a rule has one condition or no condition, the logical operator does not affect the evaluation result.
The below example shows how to set the proper logical operator between conditions, when creating rules.
</p>

<pre class="prettyprint">
// Composing an event and conditions
context_trigger_rule_entry_h battery_event;
context_trigger_rule_event_create(CONTEXT_TRIGGER_EVENT_BATTERY, CONTEXT_TRIGGER_LOGICAL_CONJUNCTION, &battery_event);
context_trigger_rule_entry_add_key(battery_event, CONTEXT_TRIGGER_LOGICAL_CONJUNCTION, CONTEXT_TRIGGER_LEVEL);
context_trigger_rule_entry_add_comparison_string(battery_event, CONTEXT_TRIGGER_LEVEL, CONTEXT_TRIGGER_EQUAL_TO, CONTEXT_TRIGGER_CRITICAL);

context_trigger_rule_entry_h gps_condition;
context_trigger_rule_condition_create(CONTEXT_TRIGGER_CONDITION_GPS, CONTEXT_TRIGGER_LOGICAL_CONJUNCTION, &gps_condition);
context_trigger_rule_entry_add_key(gps_condition, CONTEXT_TRIGGER_LOGICAL_CONJUNCTION, CONTEXT_TRIGGER_STATE);
context_trigger_rule_entry_add_comparison_string(gps_condition, CONTEXT_TRIGGER_STATE, CONTEXT_TRIGGER_NOT_EQUAL_TO, CONTEXT_TRIGGER_DISABLED);

context_trigger_rule_entry_h wifi_condition;
context_trigger_rule_condition_create(CONTEXT_TRIGGER_CONDITION_WIFI, CONTEXT_TRIGGER_LOGICAL_CONJUNCTION, &wifi_condition);
context_trigger_rule_entry_add_key(wifi_condition, CONTEXT_TRIGGER_LOGICAL_CONJUNCTION, CONTEXT_TRIGGER_STATE);
context_trigger_rule_entry_add_comparison_string(wifi_condition, CONTEXT_TRIGGER_STATE, CONTEXT_TRIGGER_NOT_EQUAL_TO, CONTEXT_TRIGGER_DISABLED);

// Composing a rule "when battery level becomes critical, if GPS <b>AND</b> WiFi is enabled"
context_trigger_rule_h conjunction_rule;
context_trigger_rule_create(<b>CONTEXT_TRIGGER_LOGICAL_CONJUNCTION</b>, &conjunction_rule);
context_trigger_rule_add_entry(conjunction_rule, battery_event);
context_trigger_rule_add_entry(conjunction_rule, gps_condition);
context_trigger_rule_add_entry(conjunction_rule, wifi_condition);
context_trigger_rule_set_action_notification(conjunction_rule, ...);

// Composing a rule "when battery level becomes critical, if GPS <b>OR</b> WiFi is enabled"
context_trigger_rule_h disjunction_rule;
context_trigger_rule_create(<b>CONTEXT_TRIGGER_LOGICAL_DISJUNCTION</b>, &disjunction_rule);
context_trigger_rule_add_entry(disjunction_rule, battery_event);
context_trigger_rule_add_entry(disjunction_rule, gps_condition);
context_trigger_rule_add_entry(disjunction_rule, wifi_condition);
context_trigger_rule_set_action_notification(disjunction_rule, ...);
</pre>

<h4>Combining Attributes into an Event or a Condition</h4>

<p>
Some event/condition items provide multiple attributes.
Naturally, the logical connection between attributes needs to be set properly to fulfill your requirement.
For example, when you use <span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_EVENT_ON_TIME</span> to define a rule "at 4 PM every Monday",
the comparisons regarding the two attributes, <span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_TIME_OF_DAY</span>
and <span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_DAY_OF_WEEK</span> should be satisfied together.
</p>
<p>
On the contrary, using <span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_APP_USE_FREQUENCY</span>,
if you want to check whether a specific application belongs to the top-5 most frequently used applications,
or the application was used at least 10 times per day on average,
the both comparisons against <span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_RANK</span> and
<span style="font-family: Courier New,Courier,monospace">CONTEXT_TRIGGER_AVERAGE_COUNT</span> need to be connected by logical disjunction.
</p>
<p>
The example below illustrates the cases described above
</p>

<pre class="prettyprint">
// Composing an event "at 4 PM every Monday"
context_trigger_rule_entry_h time_event;
context_trigger_rule_event_create(CONTEXT_TRIGGER_EVENT_ON_TIME, <b>CONTEXT_TRIGGER_LOGICAL_CONJUNCTION</b>, &time_event);
context_trigger_rule_entry_add_key(time_event, CONTEXT_TRIGGER_LOGICAL_CONJUNCTION,  CONTEXT_TRIGGER_TIME_OF_DAY);
context_trigger_rule_entry_add_comparison_int(time_event, CONTEXT_TRIGGER_TIME_OF_DAY, CONTEXT_TRIGGER_EQUAL_TO, 16);
context_trigger_rule_entry_add_key(time_event, CONTEXT_TRIGGER_LOGICAL_CONJUNCTION,  CONTEXT_TRIGGER_DAY_OF_WEEK);
context_trigger_rule_entry_add_comparison_string(time_event, CONTEXT_TRIGGER_DAY_OF_WEEK, CONTEXT_TRIGGER_EQUAL_TO, CONTEXT_TRIGGER_MON);

// Composing a condition "if an application belongs to the top-5 most frequently used apps, or is used at least 10 times per day"
context_trigger_rule_entry_h app_condition;
context_trigger_rule_condition_create(CONTEXT_TRIGGER_CONDITION_APP_USE_FREQUENCY, <b>CONTEXT_TRIGGER_LOGICAL_DISJUNCTION</b>, &app_condition);
context_trigger_rule_entry_add_option_string(app_condition, CONTEXT_TRIGGER_APP_ID, /* Application ID */);
context_trigger_rule_entry_add_key(app_condition, CONTEXT_TRIGGER_LOGICAL_CONJUNCTION, CONTEXT_TRIGGER_RANK);
context_trigger_rule_entry_add_comparison_int(app_condition, CONTEXT_TRIGGER_RANK, CONTEXT_TRIGGER_LESS_THAN_OR_EQUAL_TO, 5);
context_trigger_rule_entry_add_key(app_condition, CONTEXT_TRIGGER_LOGICAL_CONJUNCTION, CONTEXT_TRIGGER_AVERAGE_COUNT);
context_trigger_rule_entry_add_comparison_int(app_condition, CONTEXT_TRIGGER_AVERAGE_COUNT, CONTEXT_TRIGGER_GREATER_THAN_OR_EQUAL_TO, 10);
</pre>

<h4>Combining Comparisons into an Attribute</h4>

<p>
In similar with the above examples, regarding an attribute, you may need to combine multiple comparisons in difference ways.
For example, you may want to check that the battery level is full or high, <i>i.e.</i>, a logical disjunction.
You may also want to check whether the current time is between 18:30 to 21:30, <i>i.e.</i>, a logical conjunction.
See the below example illustrating how to compose such conditions.
</p>

<pre class="prettyprint">
// Composing a condition "if the battery level is full or high"
context_trigger_rule_entry_h battery_condition;
context_trigger_rule_condition_create(CONTEXT_TRIGGER_CONDITION_BATTERY, CONTEXT_TRIGGER_LOGICAL_CONJUNCTION, &battery_condition);
context_trigger_rule_entry_add_key(battery_condition, <b>CONTEXT_TRIGGER_LOGICAL_DISJUNCTION</b>, CONTEXT_TRIGGER_LEVEL);
context_trigger_rule_entry_add_comparison_string(battery_condition, CONTEXT_TRIGGER_LEVEL, CONTEXT_TRIGGER_EQUAL_TO, CONTEXT_TRIGGER_FULL);
context_trigger_rule_entry_add_comparison_string(battery_condition, CONTEXT_TRIGGER_LEVEL, CONTEXT_TRIGGER_EQUAL_TO, CONTEXT_TRIGGER_HIGH);

// Composing a condition "if the current time is between 18:30 and 21:30"
context_trigger_rule_entry_h time_condition;
context_trigger_rule_condition_create(CONTEXT_TRIGGER_CONDITION_TIME_OF_DAY, CONTEXT_TRIGGER_LOGICAL_CONJUNCTION, &time_condition);
context_trigger_rule_entry_add_key(time_condition, <b>CONTEXT_TRIGGER_LOGICAL_CONJUNCTION</b>,  CONTEXT_TRIGGER_TIME_OF_DAY);
context_trigger_rule_entry_add_comparison_int(time_condition, CONTEXT_TRIGGER_TIME_OF_DAY, CONTEXT_TRIGGER_GREATER_THAN_OR_EQUAL_TO, 1110);
context_trigger_rule_entry_add_comparison_int(time_condition, CONTEXT_TRIGGER_TIME_OF_DAY, CONTEXT_TRIGGER_LESS_THAN_OR_EQUAL_TO, 1290);
</pre>


<h2 id="action" name="action">Actions</h2>

<p>
When a rule is satisfied, the event occurred and the conditions are satisfied, the corresponding action is triggered.
One action can be set on a rule, the action can be one of the followings:
</p>

<ul>
	<li><em>App Launching Request</em>:<br>
		The contextual trigger allows to set an <a href="../app/application_n.htm#app_controls">App Control</a> as an action.
		You can utilize the functionalities of the App Control, by developing an application with the corresponding app controls if necessary,
		to execute a series of tasks when a rule is satisfied.
	<li><em>Notification Posting</em>:<br>
		A basic form of notification can be set as an action.
		A notification can contain a title, a content body text, an icon, and an app control to be executed.
		See the <a href="../app/notification_n.htm">Notification</a> for more details.
</ul>


<script type="text/javascript" src="../../scripts/jquery.zclip.min.js"></script>
<script type="text/javascript" src="../../scripts/showhide.js"></script>
</div></div></div>

<a class="top sms" href="#"><img src="../../images/btn_top.gif" alt="Go to top" /></a>
<div id="footer">
<p class="footer">Except as noted, this content - excluding the Code Examples - is licensed under <a href="http://creativecommons.org/licenses/by/3.0/legalcode" target="_blank">Creative Commons Attribution 3.0</a> and all of the Code Examples contained herein are licensed under <a href="https://www.tizen.org/bsd-3-clause-license" target="_blank">BSD-3-Clause</a>.<br/>For details, see the <a href="https://www.tizen.org/content-license" target="_blank">Content License</a>.</p>
</div>

<script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-25976949-1']);
_gaq.push(['_trackPageview']);
(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script>

</body>
</html>
