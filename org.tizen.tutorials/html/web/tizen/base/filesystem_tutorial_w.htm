<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=9" />
    <link rel="stylesheet" type="text/css" href="../../../css/styles.css" />
    <link rel="stylesheet" type="text/css" href="../../../css/snippet.css" />
    <script type="text/javascript" src="../../../scripts/snippet.js"></script>
    <script type="text/javascript" src="../../../scripts/jquery.util.js" charset="utf-8"></script>
    <script type="text/javascript" src="../../../scripts/common.js" charset="utf-8"></script>
    <script type="text/javascript" src="../../../scripts/core.js" charset="utf-8"></script>
    <script type="text/javascript" src="../../../scripts/search.js" charset="utf-8"></script>

    <title>Filesystem: Providing Access to the Device File System</title>
</head>

<body onload="prettyPrint()" style="overflow: auto;">

<div id="toc-navigation">
    <div id="profile">
        <p><img alt="Mobile Web" src="../../../images/mobile_s_w.png"/> <img alt="Wearable Web" src="../../../images/wearable_s_w.png"/></p>
    </div>
    <div id="toc_border"><div id="toc">
		<p class="toc-title">Content</p>
		<ul class="toc">
			<li><a href="#manage">Managing File Storages</a>
			</li>
			<li><a href="#create">Creating and Deleting Files and Directories</a>
			</li>
			<li><a href="#retrieve">Retrieving Files and File Details</a>
			</li>
			<li><a href="#file_dir">Managing Files and Directories</a>
			</li>
		</ul>
        <p class="toc-title">Related Info</p>
        <ul class="toc">
             <li><a href="../../../../../org.tizen.guides/html/web/tizen/base/filesystem_w.htm">Filesystem Guide</a></li>
			<li><a href="../../../../../org.tizen.web.apireference/html/device_api/mobile/tizen/filesystem.html">Filesystem API for Mobile Web</a></li>
			<li><a href="../../../../../org.tizen.web.apireference/html/device_api/wearable/tizen/filesystem.html">Filesystem API for Wearable Web</a></li>			 
        </ul>
    </div></div>
</div>

<div id="container"><div id="contents"><div class="content">
<h1>Filesystem: Providing Access to the Device File System</h1>

<p>This tutorial demonstrates how you can control files and directories on the device.</p>

<p>The Filesystem API is mandatory for both Tizen mobile and wearable profiles, which means that it is supported in all mobile and wearable devices. All mandatory APIs are supported on the Tizen Emulators.</p> 

<h2>Warm-up</h2>
<p>Become familiar with the Filesystem API basics by learning about:</p>

<ul>
   <li><a href="#manage">Managing File Storages</a> <p>Retrieve file storages and storage details, and subscribe to notifications on storage state changes.</p> </li>
   <li><a href="#create">Creating and Deleting Files and Directories</a> <p>Create and delete files and directories in the file system.</p> </li>
   <li><a href="#retrieve">Retrieving Files and File Details</a> <p>Retrieve a list of files in a directory, the URI of the file, or the file content as a <span style="font-family: Courier New,Courier,monospace">DOMString</span>.</p></li>
   <li><a href="#file_dir">Managing Files and Directories</a> <p>Open, read, write, copy, move, and close files and directories.</p></li>
</ul>

     <h2>Prerequisites</h2>
      <p>To use the filesystem APIs, the application has to request permission by adding the corresponding privileges to the config.xml file.</p>
      <pre class="prettyprint">&lt;tizen:privilege name=&quot;http://tizen.org/privilege/filesystem.read&quot;/&gt;
&lt;tizen:privilege name=&quot;http://tizen.org/privilege/filesystem.write&quot;/&gt;</pre>

 <h2>Task</h2>
<p>In the <a href="task_filemanager_w.htm">File Manager</a> task, we will walk through how to manage files in your application.</p>

	
 <h2 id="manage" name="manage">Managing File Storages</h2>

  <p>Learning how to manage file storages is a basic data management skill:</p> 
  <ol> 
   <li><p>To list available storages, use the <span style="font-family: Courier New,Courier,monospace">listStorages()</span> method of the <span style="font-family: Courier New,Courier,monospace">FileSystemManager</span> interface (in <a href="../../../../../org.tizen.web.apireference/html/device_api/mobile/tizen/filesystem.html#FileSystemManager">mobile</a> and <a href="../../../../../org.tizen.web.apireference/html/device_api/wearable/tizen/filesystem.html#FileSystemManager">wearable</a> applications) to search for the storages available on the device.</p> <p>If the search is successful, a list of found <span style="font-family: Courier New,Courier,monospace">FileSystemStorage</span> objects (in <a href="../../../../../org.tizen.web.apireference/html/device_api/mobile/tizen/filesystem.html#FileSystemStorage">mobile</a> and <a href="../../../../../org.tizen.web.apireference/html/device_api/wearable/tizen/filesystem.html#FileSystemStorage">wearable</a> applications) is passed to the success event handler.</p> <pre class="prettyprint">
/* Success event handler */
function checkCorruptedRemovableDrives(storages) 
{ 
&nbsp;&nbsp;&nbsp;for (var i = 0; i &lt; storages.length; i++) 
&nbsp;&nbsp;&nbsp;{ 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (storages[i].type != &quot;EXTERNAL&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue; 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (storages[i].state == &quot;UNMOUNTABLE&quot;) 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;console.log(&quot;External drive &quot; + storages[i].label + &quot; is corrupted.&quot;);
&nbsp;&nbsp;&nbsp;}
}

/* Search for the storages */
tizen.filesystem.listStorages(checkCorruptedRemovableDrives);</pre> </li> 
   <li> <p>To get storage details based on the storage name (the <span style="font-family: Courier New,Courier,monospace">label</span> attribute), use the <span style="font-family: Courier New,Courier,monospace">getStorage()</span> method.</p> <p>The success callback receives the <span style="font-family: Courier New,Courier,monospace">FileSystemStorage</span> object containing the storage details as an input parameter.</p> <pre class="prettyprint">
/* Success event handler */
function onStorage(storage) 
{ 
&nbsp;&nbsp;&nbsp;console.log(&quot;Storage found:&quot; + storage.label);
}

/* Retrieve a storage */
tizen.filesystem.getStorage(&quot;music&quot;, onStorage);</pre> </li> 
   <li><p>To receive notifications on the storage state changes, for example, additions and removals, register an event handler with the <span style="font-family: Courier New,Courier,monospace">addStorageStateChangeListener()</span> method.</p> <p>An event is generated each time the storage state changes.</p> <pre class="prettyprint">
var watchID;

/* Define the event handler */ 
function onStorageStateChanged(storage) 
{
&nbsp;&nbsp;&nbsp;if (storage.state == &quot;MOUNTED&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;console.log(&quot;Storage &quot; + storage.label + &quot; was added!&quot;);
}

/* Register the event handler */
 watchID = tizen.filesystem.addStorageStateChangeListener(onStorageStateChanged);</pre> </li> 
   <li><p>To stop receiving the notifications, use the <span style="font-family: Courier New,Courier,monospace">removeStorageStateChangeListener()</span> method:</p> <pre class="prettyprint">
tizen.filesystem.removeStorageStateChangeListener(watchID);</pre> </li> 
  </ol> 
  
 <h2 id="create" name="create">Creating and Deleting Files and Directories</h2>

  <p>Learning how to create and delete files and directories is a basic data management skill:</p> 
  <ol> 
   <li><p>To create a file in the current directory, use the <span style="font-family: Courier New,Courier,monospace">createFile()</span> method of the <span style="font-family: Courier New,Courier,monospace">File</span> interface (in <a href="../../../../../org.tizen.web.apireference/html/device_api/mobile/tizen/filesystem.html#File">mobile</a> and <a href="../../../../../org.tizen.web.apireference/html/device_api/wearable/tizen/filesystem.html#File">wearable</a> applications):</p> <pre class="prettyprint">
var documentsDir, newFile;
tizen.filesystem.resolve(&quot;documents&quot;, function(result) 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;documentsDir = result;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newFile = documentsDir.createFile(&quot;newFilePath&quot;);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});</pre> </li> 

   <li><p>To create a directory within the file system, use the <span style="font-family: Courier New,Courier,monospace">createDirectory()</span> method.</p> <p>The directory (and any sub-directories defined in the method parameter) is created relative to the current directory where the operation is performed on.</p> <pre class="prettyprint">
var newDir = documentsDir.createDirectory(&quot;newDir&quot;);
var anotherNewDir = documentsDir.createDirectory(&quot;newDir1/subNewDir1&quot;);</pre> </li> 

   <li><p>To delete a file, use the <span style="font-family: Courier New,Courier,monospace">deleteFile()</span> method:</p> <pre class="prettyprint">
function onDelete()
{
&nbsp;&nbsp;&nbsp;console.log(&quot;deletedFile() is successfully done.&quot;);
}

documentsDir.deleteFile(newFile.fullPath, onDelete);</pre> </li> 
   <li><p>To delete a directory, use the <span style="font-family: Courier New,Courier,monospace">deleteDirectory()</span> method.</p> <p>The second parameter defines whether the deletion is performed recursively for the sub-directories as well. If the parameter is set to <span style="font-family: Courier New,Courier,monospace">false</span>, the directory is deleted only if it is empty.</p> <pre class="prettyprint">
documentsDir.deleteDirectory(newDir.fullPath, false, onDelete);
anotherNewDir.parent.deleteDirectory(anotherNewDir.fullPath, false, onDelete);</pre> </li> 
  </ol> 
  
 <h2 id="retrieve" name="retrieve">Retrieving Files and File Details</h2>
			
  <p>Learning how to get files and file details from the file system is a basic data management skill:</p> 
  <ol> 
   <li><p>To access a specific file or directory within the file system, retrieve a file handle using the <span style="font-family: Courier New,Courier,monospace">resolve()</span> method of the <span style="font-family: Courier New,Courier,monospace">FileSystemManager</span> interface (in <a href="../../../../../org.tizen.web.apireference/html/device_api/mobile/tizen/filesystem.html#FileSystemManager">mobile</a> and <a href="../../../../../org.tizen.web.apireference/html/device_api/wearable/tizen/filesystem.html#FileSystemManager">wearable</a> applications):</p> <pre class="prettyprint">
tizen.filesystem.resolve(&#39;documents&#39;, onResolveSuccess, null, &#39;r&#39;);</pre> <p>The <span style="font-family: Courier New,Courier,monospace">File</span> object (in <a href="../../../../../org.tizen.web.apireference/html/device_api/mobile/tizen/filesystem.html#File">mobile</a> and <a href="../../../../../org.tizen.web.apireference/html/device_api/wearable/tizen/filesystem.html#File">wearable</a> applications) is returned in the success event handler.</p> </li> 
   <li>To retrieve a list of all the files and their directories located in a specified directory, use the <span style="font-family: Courier New,Courier,monospace">listFiles()</span> method of the <span style="font-family: Courier New,Courier,monospace">File</span> object:<p></p> <pre class="prettyprint">
function onResolveSuccess(dir)
{  
&nbsp;&nbsp;&nbsp;dir.listFiles(onsuccess);
}</pre> <p>The method returns an array of <span style="font-family: Courier New,Courier,monospace">File</span> objects.</p> </li> 
   <li><p>To retrieve the file URI, use the <span style="font-family: Courier New,Courier,monospace">toURI()</span> method:</p> <pre class="prettyprint">
function onsuccess(files) 
{ 
&nbsp;&nbsp;&nbsp;for (var i = 0; i &lt; files.length; i++) 
&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/* Display the file name and URI */
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;console.log(&quot;File name is &quot; + files[i].name + &quot;, URI is &quot; + files[i].toURI());</pre> </li> 
   <li><p>To retrieve the file content as a DOMString, use the <span style="font-family: Courier New,Courier,monospace">readAsText()</span> method. </p><p>The encoding input parameter of the method defines the format in which the file content is returned.</p> <pre class="prettyprint">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (files[i].isDirectory == false) 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;files[i].readAsText(function(str) {console.log(&quot;File content: &quot; + str);}, null, &quot;UTF-8&quot;);
&nbsp;&nbsp;&nbsp;}
}</pre> </li> 
  </ol> 
  
 <h2 id="file_dir" name="file_dir">Managing Files and Directories</h2>

  <p>Learning how to read and write to files, and move and copy files and directories, is a basic data management skill:</p> 
  <ol> 
   <li><p>To open a file, use the <span style="font-family: Courier New,Courier,monospace">openStream()</span> method of the <span style="font-family: Courier New,Courier,monospace">File</span> interface (in <a href="../../../../../org.tizen.web.apireference/html/device_api/mobile/tizen/filesystem.html#File">mobile</a> and <a href="../../../../../org.tizen.web.apireference/html/device_api/wearable/tizen/filesystem.html#File">wearable</a> applications).</p> <p>The method returns a <span style="font-family: Courier New,Courier,monospace">FileStream</span> object (in <a href="../../../../../org.tizen.web.apireference/html/device_api/mobile/tizen/filesystem.html#FileStream">mobile</a> and <a href="../../../../../org.tizen.web.apireference/html/device_api/wearable/tizen/filesystem.html#FileStream">wearable</a> applications), which is a handle to the opened file. </p> <pre class="prettyprint">
var documentsDir;

tizen.filesystem.resolve(&quot;documents&quot;, function(result) 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;documentsDir = result;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});

var testFile = documentsDir.createFile(&quot;test.txt&quot;);
if (testFile != null) 
{
&nbsp;&nbsp;&nbsp;testFile.openStream(&quot;rw&quot;, onOpenSuccess, null, &quot;UTF-8&quot;);
}</pre> </li> 
   <li><p></p>Perform all actual operations, such as reading, writing, or closing, on the file through the <span style="font-family: Courier New,Courier,monospace">FileStream</span> object based on a position attribute, which represents the current position in the file:<p></p> <pre class="prettyprint">
function onOpenSuccess(fs)
{
&nbsp;&nbsp;&nbsp;/* Write HelloWorld to the file */
&nbsp;&nbsp;&nbsp;fs.write(&quot;HelloWorld&quot;);

&nbsp;&nbsp;&nbsp;/* Move pointer to begin */
&nbsp;&nbsp;&nbsp;fs.position = 0;

&nbsp;&nbsp;&nbsp;/* Read the file content from the beginning*/
&nbsp;&nbsp;&nbsp;fs.read(testFile.fileSize);

&nbsp;&nbsp;&nbsp;/* Close the file */
&nbsp;&nbsp;&nbsp;fs.close();
}
</pre> </li> 
   <li><p>To copy a file or directory, use the <span style="font-family: Courier New,Courier,monospace">copyTo()</span> method. The following example copies the files to the <span style="font-family: Courier New,Courier,monospace">images/backup/</span> directory. Since the third parameter is set to <span style="font-family: Courier New,Courier,monospace">true</span>, any existing files with the same name in the target directory are overwritten.</p> <pre class="prettyprint">
var files; /* Assume that this is an array of File objects */
function onSuccess()
{
&nbsp;&nbsp;&nbsp;console.log(&quot;success&quot;);
}

for (var i = 0; i &lt; files.length; i++) 
{
&nbsp;&nbsp;&nbsp;documentsDir.copyTo(files[i].fullPath, &quot;images/backup/&quot;+files[i].name,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;true, onSuccess);
}
</pre> </li> 
   <li><p>To move a file or directory, use the <span style="font-family: Courier New,Courier,monospace">moveTo()</span> method. The following example moves the files to the <span style="font-family: Courier New,Courier,monospace">images/newFolder/</span> directory. Since the third parameter is set to <span style="font-family: Courier New,Courier,monospace">false</span>, no existing files with the same name in the target directory are overwritten.</p> <pre class="prettyprint">
var files; /* Assume that this is an array of File objects */

for (var i = 0; i &lt; files.length; i++) 
{
&nbsp;&nbsp;&nbsp;documentsDir.moveTo(files[i].fullPath, &quot;images/newFolder/&quot;+files[i].name,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;false, onSuccess);
}
</pre> </li> 
  </ol> 
 
            
<script type="text/javascript" src="../../../scripts/jquery.zclip.min.js"></script>
<script type="text/javascript" src="../../../scripts/showhide.js"></script>

</div></div></div>

<a class="top sms" href="#"><img src="../../../images/btn_top.gif" alt="Go to top" /></a>

<div id="footer">
<p class="footer">Except as noted, this content - excluding the Code Examples - is licensed under <a href="http://creativecommons.org/licenses/by/3.0/legalcode" target="_blank">Creative Commons Attribution 3.0</a> and all of the Code Examples contained herein are licensed under <a href="https://www.tizen.org/bsd-3-clause-license" target="_blank">BSD-3-Clause</a>.<br/>For details, see the <a href="https://www.tizen.org/content-license" target="_blank">Content License</a>.</p>
</div>

<script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-25976949-1']);
_gaq.push(['_trackPageview']);
(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script>

</body>
</html>
