<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=9" />
    <link rel="stylesheet" type="text/css" href="../../css/styles.css" />
    <link rel="stylesheet" type="text/css" href="../../css/snippet.css" />
    <script type="text/javascript" src="../../scripts/snippet.js"></script>
    <script type="text/javascript" src="../../scripts/jquery.util.js" charset="utf-8"></script>
    <script type="text/javascript" src="../../scripts/common.js" charset="utf-8"></script>
    <script type="text/javascript" src="../../scripts/core.js" charset="utf-8"></script>
    <script type="text/javascript" src="../../scripts/search.js" charset="utf-8"></script>

    <title>Metadata Editor: Editing Metadata from an Input Audio File</title>
</head>

<body onload="prettyPrint()" style="overflow: auto;">

<div id="navigation">
    <div id="profile">
        <p><img alt="Mobile native" src="../../images/mn_icon.png"/></p>
    </div>
    <div id="toc_border"><div id="toc">
 		<p class="toc-title">Content</p>
		<ul class="toc">
				<li><a class="opensection" href="#init_metadata">Initializing the Metadata Editor</a></li>
				<li><a class="opensection" href="#edit_metadata">Editing Metadata, Artwork</a></li>
		</ul>  
        <p class="toc-title">Related Info</p>
        <ul class="toc">
            <li><a href="../../../../org.tizen.guides/html/native/multimedia/metadata_editor_n.htm">Metadata Editor Guide</a></li>
			<li><a href="../../../../org.tizen.native.mobile.apireference/group__CAPI__METADATA__EDITOR__MODULE.html">Metadata Editor API</a></li>
        </ul>
    </div></div>
</div>

<div id="container"><div id="contents"><div class="content">
<h1>Metadata Editor: Editing Metadata from an Input Audio File</h1>
  <div class="cont"><div class="static-cont">
  
<p>This tutorial demonstrates how you can edit metadata to audio files.</p>

<h2>Warm-up</h2>

<p>Become familiar with the Metadata Editor API basics by learning about:</p>

	<ul>
			<li><a class="opensection" href="#init_metadata">Initializing the Metadata Editor</a>
			<p>Initialize the metadata editor for use.</p></li>
			<li><a class="opensection" href="#edit_metadata">Editing Metadata, Artwork</a>
			<p>Create a metadata editor handle, bind the handle with the file, edit metadata and artwork, and apply to the file.</p></li>
	</ul>
        
<div class="devicespecs-util mt5 clfix">
		<ul class="dutil">
			<li><a href="#" class="showA">Show All</a></li>
			<li class="none"><a href="#" class="hideA">Hide All</a></li>
		</ul>
	</div>

		<ul class="devicespecifications">
		<li>
			<div class="devicespec-tit">
 <h2 id="init_metadata" name="init_metadata" class="items-tit-h2">Initializing the Metadata Editor</h2>
<span class="fr"><a href="#" class="bt-arr"><em>Hide</em></a></span>
  </div>
			<div class="devicespec-con"> 
<table class="note"> 
   <tbody> 
    <tr> 
     <th class="note">Note</th> 
    </tr> 
    <tr> 
     <td class="note">The metadata editor can only be used with audio files. It is not supported in the image and video files.</td> 
    </tr> 
   </tbody> 
  </table>  
<p>To initialize the metadata editor:</p>
  <ol>

<li><p>To use the functions and data types of the <a href="../../../../org.tizen.native.mobile.apireference/group__CAPI__METADATA__EDITOR__MODULE.html">Metadata Editor</a> API, include the <span style="font-family: Courier New,Courier,monospace;">&lt;metadata_editor.h&gt;</span> header file in your application:</p>
<pre class="prettyprint">
#include &lt;metadata_editor.h&gt;
</pre></li><li><p>To work with the Metadata Editor API, create a handle to the metadata editor. A global variable is used in this tutorial:</p>

<pre class="prettyprint">
static metadata_editor_h g_metadata_h = NULL;
</pre></li>

<li><p>This tutorial use a files - an audio file in the mp3 format.</p>

<p>You must get the default path for this tutorial.  For the following example code, you must include the <span style="font-family: Courier New,Courier,monospace;">&lt;storage.h&gt;</span> header file.</p>
<pre class="prettyprint">
int internal_storage_id;
char *internal_music_storage_path;
char *music_file_name = &quot;test_music.mp3&quot;;
char *music_test_path;

static bool storage_cb(int storage_id, storage_type_e type, storage_state_e state, const char *path, void *user_data)
{
&nbsp;&nbsp;&nbsp;if (type == STORAGE_TYPE_INTERNAL)
&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;internal_storage_id = storage_id;

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return false;
&nbsp;&nbsp;&nbsp;}

&nbsp;&nbsp;&nbsp;return true;
}

void _get_internal_storage_path()
{
&nbsp;&nbsp;&nbsp;int error;
&nbsp;&nbsp;&nbsp;char *path = NULL;

&nbsp;&nbsp;&nbsp;error = storage_foreach_device_supported(storage_cb, NULL);
&nbsp;&nbsp;&nbsp;error = storage_get_directory(internal_storage_id, STORAGE_DIRECTORY_MUSIC, &amp;path);
&nbsp;&nbsp;&nbsp;if (error != STORAGE_ERROR_NONE) 
&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;internal_music_storage_path = strdup(path);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;free(path);
&nbsp;&nbsp;&nbsp;}
} 

void _make_test_path()
{
&nbsp;&nbsp;&nbsp;int path_len = 0;

&nbsp;&nbsp;&nbsp;path_len = strlen(internal_music_storage_path) + strlen(music_file_name) + 1;
&nbsp;&nbsp;&nbsp;music_test_path = malloc(path_len);
&nbsp;&nbsp;&nbsp;memset(music_test_path, 0x0, path_len);

&nbsp;&nbsp;&nbsp;strncat(music_test_path, internal_music_storage_path, strlen(internal_music_storage_path));
&nbsp;&nbsp;&nbsp;strncat(music_test_path, music_file_name, strlen(music_file_name));
}
</pre>
</li></ol>
<p>The metadata editor APIs can use not only common content in the storage (internal or external), but also the private content in your application data.</p>  
	</div>
		</li>			
		<li>
			<div class="devicespec-tit">
 <h2 id="edit_metadata" name="edit_metadata" class="items-tit-h2">Editing Metadata, Artwork</h2>
<span class="fr"><a href="#" class="bt-arr"><em>Hide</em></a></span>
  </div>
			<div class="devicespec-con"> 
<p>To edit metadata in the file:</p>
<ol>
<li>Create the metadata editor handle.

<p>Use the <span style="font-family: Courier New,Courier,monospace;">metadata_editor_create()</span> function. This is necessary to prepare the metadata editor handle for work.</p>

<pre class="prettyprint">
ret = metadata_editor_create(&amp;g_metadata_h);
</pre></li>
<li>Set the path to the file whose data you want to obtain.

<p>Use the <span style="font-family: Courier New,Courier,monospace;">metadata_editor_set_path()</span> function. It binds the handle with the media file specified in the <span style="font-family: Courier New,Courier,monospace;">music_test_path</span>, passed as a second argument to this function.</p>

<pre class="prettyprint">
ret = metadata_editor_set_path(g_metadata_h, music_test_path);
</pre></li>
<li>Edit metadata in the file.

<p>Use the <span style="font-family: Courier New,Courier,monospace;">metadata_extractor_set_metadata()</span> function, which takes 3 parameters. The first one is the handle to the metadata editor. The second parameter is the wanted data type. The possible values for this parameter are those defined in the <a href="../../../../org.tizen.native.mobile.apireference/group__CAPI__METADATA__EDITOR__MODULE.html#ga5b27fedbf5aaa22106f88b831c596872">metadata_editor_attr_e</a> enumeration. The final parameter is the fixed value that is a pointer to the <span style="font-family: Courier New,Courier,monospace;">char</span> variable and is fulfilled by the function.</p>

<pre class="prettyprint">
char *value = "rename";

ret = metadata_editor_set_metadata(g_metadata_h, METADATA_EDITOR_ATTR_TITLE, value);

</pre>

<p>After calling the function, check whether the value returned by the function is equal to <span style="font-family: Courier New,Courier,monospace;">METADATA_EDITOR_ERROR_NONE</span>. If it is not, an error occurred. You can check the updated metadata using <span style="font-family: Courier New,Courier,monospace;">metadata_editor_get_metadata()</span> function. 
However, the updated information is not applied to the file yet. If you want to apply in the file, you have to use update function. Update fuction example is described in the next chapter.</p>
<p>
The other types of metadata attributes can be updated in the exactly same way. Just change the second parameter during calling the function to edit different attributes of the metadata.
</p>
</li>
<li>Append the artwork of the file.

<p>Use the <span style="font-family: Courier New,Courier,monospace;">metadata_editor_append_picture()</span> function.</p>
<p>This function takes 2 parameters. The first one is the handle to the metadata editor. Other parameter is the image path to append. Artwork is possible only jpg and png files. 
And added image is added to the last position. After append image, like <span style="font-family: Courier New,Courier,monospace;">metadata_extractor_set_metadata()</span> function, you have to use update function for apply to the file. 
</p>

<pre class="prettyprint">
char *artwork = "append_image.jpg";

ret = metadata_editor_append_picture(g_metadata_h, artwork);
</pre>
<p>If you want to remove a picture, you use <span style="font-family: Courier New,Courier,monospace;">metadata_editor_remove_picture()</span> function. But different, there is no need path, it just need index number. You can get the number of images by using <span style="font-family: Courier New,Courier,monospace;">metadata_editor_get_metadata()</span> function.
And You can get the image file by using <span style="font-family: Courier New,Courier,monospace;">metadata_editor_get_picture()</span> function. 
</p>

<pre class="prettyprint">
int index = 0;

ret = metadata_editor_remove_picture(g_metadata_h, index);
</pre>
</li>

<li>Apply the updated metadata to the file.
<p>After use the <span style="font-family: Courier New,Courier,monospace;">metadata_editor_set_metadata()</span> function, <span style="font-family: Courier New,Courier,monospace;">metadata_editor_append_metadata()</span> function or <span style="font-family: Courier New,Courier,monospace;">metadata_editor_remove_picture()</span> function,  
You have to use the <span style="font-family: Courier New,Courier,monospace;">metadata_editor_update_metadata()</span> function for applying to the file.</p>
<pre class="prettyprint">
ret = metadata_editor_update_metadata(g_metadata_h);
</pre>
</li>

<li>Clean up on the application end.
<pre class="prettyprint">
metadata_editor_destroy(g_metadata_h);
</pre></li>
</ol>
	</div>
		</li>				
	</ul>	
</div>				
</div>      

<script type="text/javascript" src="../../scripts/jquery.zclip.min.js"></script>
<script type="text/javascript" src="../../scripts/showhide.js"></script>

</div></div></div>

<a class="top sms" href="#"><img src="../../images/btn_top.gif" alt="Go to top" /></a>

<div id="footer">
<p class="footer">Except as noted, this content - excluding the Code Examples - is licensed under <a href="http://creativecommons.org/licenses/by/3.0/legalcode" target="_blank">Creative Commons Attribution 3.0</a> and all of the Code Examples contained herein are licensed under <a href="https://www.tizen.org/bsd-3-clause-license" target="_blank">BSD-3-Clause</a>.<br/>For details, see the <a href="https://www.tizen.org/content-license" target="_blank">Content License</a>.</p>
</div>

<script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-25976949-1']);
_gaq.push(['_trackPageview']);
(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script>

</body>
</html>
