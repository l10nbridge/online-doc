<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=9" />
	<link rel="stylesheet" type="text/css" href="../../css/styles.css" />
	<link rel="stylesheet" type="text/css" href="../../css/snippet.css" />
	<script type="text/javascript" src="../../scripts/snippet.js"></script>
	<script type="text/javascript" src="../../scripts/jquery.util.js" charset="utf-8"></script>
	<script type="text/javascript" src="../../scripts/common.js" charset="utf-8"></script>
	<script type="text/javascript" src="../../scripts/core.js" charset="utf-8"></script>
	<script type="text/javascript" src="../../scripts/search.js" charset="utf-8"></script>

	<title>Sync Manager: Managing all sync related activities</title>
</head>

<body onload="prettyPrint()" style="overflow: auto;">

<div id="navigation">
	<div id="profile">
		<p><img alt="Mobile native" src="../../images/mn_icon.png"/></p>
	</div>
	<div id="toc_border"><div id="toc">
		<p class="toc-title">Content</p>
		<ul class="toc">
			<li><a href="#on_demand_sync">On Demand Sync</a></li>
			<li><a href="#periodic_sync">Periodic Sync</a></li>
		</ul>
		<p class="toc-title">Related Info</p>
		<ul class="toc">
            <li><a href="../../../../org.tizen.guides/html/native/sync/sync_guide_n.htm">Sync Guide</a></li>
			<li><a href="../../../../org.tizen.native.mobile.apireference/group__CAPI__SYNC__MANAGER__MODULE.html">Sync Manager API</a></li>
		</ul>
	</div></div>
</div>

<div id="container"><div id="contents"><div class="content">
<h1>Sync Manager: Managing all sync related activities</h1>
<div class="cont"><div class="static-cont">

	<p>This tutorial demonstrates how you can manage the schedule of time to synchronize data. The Sync Manager API provides function which can control sync operation manually or periodically:</p>

  <h2>Warm-up</h2>
    <p>Become familiar with the Sync Manager API basics by learning about:</p>
	<ul>
		<li><a href="#on_demand_sync">On Demand Sync</a>
		<p>Add on demand sync job scheduling for one time operation.</p></li>
		<li><a href="#periodic_sync">Periodic Sync</a>
		<p>Add periodic sync job scheduling with a cycle.</p></li>
	</ul>

<div class="devicespecs-util mt5 clfix">
		<ul class="dutil">
			<li><a href="#" class="showA">Show All</a></li>
			<li class="none"><a href="#" class="hideA">Hide All</a></li>
		</ul>
	</div>
	<!-- Folds -->
	<ul class="devicespecifications">
		<li>
			<div class="devicespec-tit">
				<h2 id="on_demand_sync" name="on_demand_sync" class="items-tit-h2">On Demand Sync</h2>
				<span class="fr"><a href="#" class="bt-arr"><em>Hide</em></a></span>
			</div>
			<div class="devicespec-con">

<p>To inform explicitly service app of a time to sync operation once.</p>

<ol>
<li>To use the features of the <a href="../../../../org.tizen.native.mobile.apireference/group__CAPI__SYNC__MANAGER__MODULE.html">Sync Manager</a> API, include the &lt;sync_manager.h&gt; header file in your application:
<pre class="prettyprint">
#include &lt;sync_manager.h&gt;
</pre>
</li>

<li>Sync Adapter callbacks should be set first. Setting Sync Adapter callbacks can be verified at <a href="sync_adapter_tutorial_n.htm">Sync Adapter</a>. To set callbacks, as follows:
<pre class="prettyprint">
#include &lt;sync_adapter.h&gt;

const char* capability = "http://tizen.org/account/capability/contact";
int result;
result = sync_adapter_init(capability);
result = sync_adapter_set_callbacks(on_start_cb, on_cancel_cb);
</pre>
In the case of accountless, as follows:
<pre class="prettyprint">
result = sync_adapter_init(NULL);
result = sync_adapter_set_callbacks(on_start_cb, on_cancel_cb);
</pre>
</li>

<li>Connect to Sync Manager service using the sync_manager_connect() function:
<pre class="prettyprint">
result = sync_manager_connect();
</pre>
</li>

<li>In the case of using Account, Account and bundle creation should be performed previously for sync_manager_add_sync_job()'s parameters. But, Account handle is not a mandatory parameter. Because, that is for an application which want to use the Sync Manager without Account. See the <a href="../social/account_tutorial_n.htm">Creating and Managing an Account</a> part for Account creation in Account Tutorial. Also, see the <a href="../app_framework/bundle_tutorial_n.htm">Managing and Using the Bundle Content</a> part for Bundle creation in Bundle Tutorial. For example,:
<pre class="prettyprint">
account_h account = NULL;
int account_id = -1;
bundle *extra = NULL;

account_connect();
account_create(&amp;account);
account_set_user_name(account, "test_name");
account_set_email_address(account, "test_email@samsung.com");
account_set_package_name(account, "data-sync-module");
account_set_sync_support(account, ACCOUNT_SUPPORTS_SYNC);
account_insert_to_db(account, &amp;account_id);
account_disconnect();

extra = bundle_create();
bundle_add(extra, SYNC_OPTION_NO_RETRY, "true");
bundle_add(extra, SYNC_OPTION_EXPEDITED, "false");
</pre>
The above example creates bundle and adds option for sync related information. If the SYNC_OPTION_NO_RETRY is set as true, sync service will not retry operation when sync operation is failed.
</li>

<li>To add on demand sync job, as follows:
<pre class="prettyprint">
result = sync_manager_add_sync_job(account, capability, extra);
</pre>
In the case of accountless, as follows:
<pre class="prettyprint">
result = sync_manager_add_sync_job(NULL, NULL, extra);
</pre>
If sync job process had been made well, returns value SYNC_ERROR_NONE.
</li>

<li>When on demand sync is no longer used, remove the sync job with the sync_manager_remove_sync_job() function. If you want to stop using account, should not forget clean-up account handle. Also, disconnect from Sync Manager and release the resources with the sync_manager_disconnect() function:
<pre class="prettyprint">
result = sync_manager_remove_sync_job(account, capability);

account_connect();
account_get_account_id(account, &amp;account_id);
account_delete_from_db_by_id(account_id);
account_destroy(account);
account_disconnect();

sync_manager_disconnect();
sync_adapter_unset_callbacks();
sync_adapter_destroy();
</pre>
In the case of accountless, as follows:
<pre class="prettyprint">
result = sync_manager_remove_sync_job(NULL, NULL);

sync_manager_disconnect();
sync_adapter_unset_callbacks();
sync_adapter_destroy();
</pre>
</li></li>
</ol>
			</div>
		</li>

		<li>
			<div class="devicespec-tit">
				<h2 id="periodic_sync" name="periodic_sync" class="items-tit-h2">Periodic Sync</h2>
				<span class="fr"><a href="#" class="bt-arr"><em>Hide</em></a></span>
			</div>
			<div class="devicespec-con">

<p>To inform regularly service app of times to sync operation with an interval.</p>

<ol>
<li>To use the features of the <a href="../../../../org.tizen.native.mobile.apireference/group__CAPI__SYNC__MANAGER__MODULE.html">Sync Manager</a> API, include the &lt;sync_manager.h&gt; header file in your application:
<pre class="prettyprint">
#include &lt;sync_manager.h&gt;
</pre>
</li>

<li>Sync Adapter callbacks should be set first. Setting Sync Adapter callbacks can be verified at <a href="sync_adapter_tutorial_n.htm">Sync Adapter</a>. To set callbacks, as follows:
<pre class="prettyprint">
#include &lt;sync_adapter.h&gt;

const char* capability = "http://tizen.org/account/capability/contact";
int result;
result = sync_adapter_init(capability);
result = sync_adapter_set_callbacks(on_start_cb, on_cancel_cb);
</pre>
In the case of accountless, as follows:
<pre class="prettyprint">
result = sync_adapter_init(NULL);
result = sync_adapter_set_callbacks(on_start_cb, on_cancel_cb);
</pre>
</li>

<li>Connect to Sync Manager service using the sync_manager_connect() function:
<pre class="prettyprint">
int result;
result = sync_manager_connect();
</pre>
</li>

<li>In the case of using Account, Account and bundle creation should be performed previously for sync_manager_add_sync_job()'s parameters. But, Account handle is not a mandatory parameter. Because, an application is not using the Account in order to use the Sync Manager. See the <a href="../social/account_tutorial_n.htm">Creating and Managing an Account</a> part for Account creation in Account Tutorial or above On Demand Turorial. Also, see the <a href="../app_framework/bundle_tutorial_n.htm">Managing and Using the Bundle Content</a> part for Bundle creation in Bundle Tutorial. For example,:
<pre class="prettyprint">
bundle *extra = NULL;
extra = bundle_create();
bundle_add(extra, SYNC_OPTION_NO_RETRY, "false");
bundle_add(extra, SYNC_OPTION_EXPEDITED, "false");
</pre>
The above example creates bundle and adds option for sync related information. All of the sync option is false for periodic sync request. The sync option will retry when sync operation is failed and doesn't grant priority for sync operation.
</li>

<li>To add periodic sync job, as follows:
<pre class="prettyprint">
sync_period_e sync_period = SYNC_PERIOD_INTERVAL_30MIN;
result = sync_manager_add_periodic_sync_job(account, capability, extra, sync_period);
</pre>
In the case of accountless, as follows:
<pre class="prettyprint">
result = sync_manager_add_periodic_sync_job(NULL, NULL, extra, sync_period);
</pre>
If sync job process had been made well, returns value SYNC_ERROR_NONE. Last parameter means time interval of periodic sync.
</li>

<li>When periodic sync is no longer used, remove the sync job with the sync_manager_remove_periodic_sync_job() function. If you want to stop using account, should not forget clean-up account handle. That can be verified above On Demand Tutorial. Also, disconnect from Sync Manager and release the resources with the sync_manager_disconnect() function:
<pre class="prettyprint">
result = sync_manager_remove_periodic_sync_job(account, capability);

sync_manager_disconnect();
sync_adapter_unset_callbacks();
sync_adapter_destroy();
</pre>
In the case of accountless, as follows:
<pre class="prettyprint">
result = sync_manager_remove_periodic_sync_job(NULL, NULL);

sync_manager_disconnect();
sync_adapter_unset_callbacks();
sync_adapter_destroy();
</pre>
</li>
</ol>
			</div>
		</li>

	</ul>
</div>
</div>

<script type="text/javascript" src="../../scripts/jquery.zclip.min.js"></script>
<script type="text/javascript" src="../../scripts/showhide.js"></script>

</div></div></div>

<a class="top sms" href="#"><img src="../../images/btn_top.gif" alt="Go to top" /></a>

<div id="footer">
<p class="footer">Except as noted, this content - excluding the Code Examples - is licensed under <a href="http://creativecommons.org/licenses/by/3.0/legalcode" target="_blank">Creative Commons Attribution 3.0</a> and all of the Code Examples contained herein are licensed under <a href="https://www.tizen.org/bsd-3-clause-license" target="_blank">BSD-3-Clause</a>.<br/>For details, see the <a href="https://www.tizen.org/content-license" target="_blank">Content License</a>.</p>
</div>

<script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-25976949-1']);
_gaq.push(['_trackPageview']);
(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script>

</body>
</html>

