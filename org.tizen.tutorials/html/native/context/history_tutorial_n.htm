<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=9" />
	<link rel="stylesheet" type="text/css" href="../../css/styles.css" />
	<link rel="stylesheet" type="text/css" href="../../css/snippet.css" />
	<script type="text/javascript" src="../../scripts/snippet.js"></script>
	<script type="text/javascript" src="../../scripts/jquery.util.js" charset="utf-8"></script>
	<script type="text/javascript" src="../../scripts/common.js" charset="utf-8"></script>
	<script type="text/javascript" src="../../scripts/core.js" charset="utf-8"></script>
	<script type="text/javascript" src="../../scripts/search.js" charset="utf-8"></script>
	<title>Contextual History Tutorial</title>
</head>
<body onload="prettyPrint()" style="overflow: auto;">

<div id="navigation">
	<div id="profile">
		<p><img alt="Mobile native" src="../../images/mn_icon.png"/></p>
	</div>
	<div id="toc_border"><div id="toc">
		<p class="toc-title">Content</p>
		<ul class="toc">
			<li><a href="#get_list" class="opensection">Getting a List of Data Records</a>
			<li><a href="#enumerate_list" class="opensection">Enumerating a List of Data Records</a>
		</ul>
		<p class="toc-title">Related Info</p>
		<ul class="toc">
			<li><a href="../../../../org.tizen.guides/html/native/context/history_n.htm">Contextual History Guide</a></li>
			<li><a href="../../../../org.tizen.native.mobile.apireference/group__CAPI__CONTEXT__HISTORY__MODULE.html">Contextual History API</a></li>
		</ul>
	</div></div>
</div>

<div id="container"><div id="contents"><div class="content">

<h1>Contextual History Tutorial</h1>
<div class="cont"><div class="static-cont">

<p>
This tutorial demonstrates how to get the history profiles of the device usages, and enumerate data lists retrieved.
</p>
<p>
To learn about the <a href="../../../../org.tizen.native.mobile.apireference/group__CAPI__CONTEXT__HISTORY__MODULE.html">Contextual History</a> API features,
see the <a href="../../../../org.tizen.guides/html/native/context/history_n.htm">Contextual History Programming Guide</a>.
</p>
<p>
This tutorial consists of the following parts:
</p>
<ul>
	<li><a href="#get_list" class="opensection">Getting a List of Data Records</a>
		<p>It will show how to get the history profiles of the device usages.
		A history profile retrieved via this API is formulated as a list of data records.</p></li>
	<li><a href="#enumerate_list" class="opensection">Enumerating a List of Data Records</a>
		<p>It will show how to enumerate the records contained in the list obtained in the previous step.</p></li>
</ul>

<div class="devicespecs-util mt5 clfix">
	<ul class="dutil">
		<li><a href="#" class="showA">Show All</a></li>
		<li class="none"><a href="#" class="hideA">Hide All</a></li>
	</ul>
</div>

<!-- Folds -->
<ul class="devicespecifications">

	<li>
		<div class="devicespec-tit">
			<h2 id="get_list" name="get_list" class="items-tit-h2">Getting a List of Data Records</h2>
			<span class="fr"><a href="#" class="bt-arr"><em>Hide</em></a></span>
		</div>
		<div class="devicespec-con">
			<p>
			To retrieve a contextual history profile, for example,
			<span style="font-family: Courier New,Courier,monospace;">CONTEXT_HISTORY_FREQUENTLY_USED_APP</span>,
			a <em>filter</em> needs to be set to specify the data to retrieve, then the profile can be obtained
			using <span style="font-family: Courier New,Courier,monospace;">context_history_get_list()</span>.
			</p>
			<ol>
				<li>The following header needs to be included in advance.
<pre class="prettyprint">
#include &lt;context_history.h&gt;
</pre>
				</li>
				<li>To get a history profile, two handles, one for using the contextual history API and one for the filter, are created.
<pre class="prettyprint">
// Creating a handle for using the contextual history API
context_history_h handle;
context_history_create(&handle);

// Creating a filter handle
context_history_filter_h filter;
context_history_filter_create(&filter);
</pre>
				</li>
				<li>The filter handle needs to be properly configured. In this example, we will get the top-5 frequently used applications,
					by only considering the applications used while a headphone is connected, during the last 2 weeks (14 days).
<pre class="prettyprint">
// Requesting the top-5 applications
context_history_filter_set_int(filter, CONTEXT_HISTORY_FILTER_RESULT_SIZE, 5);

// Limiting the time span of usage logs to 14 days
context_history_filter_set_int(filter, CONTEXT_HISTORY_FILTER_TIME_SPAN, 14);

// Considering the applications used while a headphone is connected
context_history_filter_set_int(filter, CONTEXT_HISTORY_FILTER_AUDIO_JACK, CONTEXT_HISTORY_FILTER_AUDIO_JACK_CONNECTED);
</pre>
				</li>
				<li>Then with that filter, the list of the top-5 applications can be retrieved as follows.
<pre class="prettyprint">
context_history_list_h list;

// Getting the list of records
context_history_get_list(handle, CONTEXT_HISTORY_FREQUENTLY_USED_APP, filter, &list);

// The filter needs to be released explicitly.
context_history_filter_destroy(filter);
</pre>
				</li>
			</ol>
		</div>
	</li>

	<li>
		<div class="devicespec-tit">
			<h2 id="enumerate_list" name="enumerate_list" class="items-tit-h2">Enumerating a List of Data Records</h2>
			<span class="fr"><a href="#" class="bt-arr"><em>Hide</em></a></span>
		</div>
		<div class="devicespec-con">
			<p>
			The <span style="font-family: Courier New,Courier,monospace;">list</span> retrieved via
			<span style="font-family: Courier New,Courier,monospace;">context_history_get_list()</span> contains
			a sort listed of the records, each of which consists of the pairs of keys and values.
			This list can be enumerated as follows.
			</p>
			<ol>
				<li>In some cases, the retrieve list may contain less records than the result size set in the filter.
					The actual number of records contained in the list can be checked before enumerating the list.
<pre class="prettyprint">
int size;
context_history_list_get_count(list, &size);
</pre>
				</li>
				<li>Then, the list can be enumerated using a loop.
<pre class="prettyprint">
int i, count;
char* app_id;
context_history_record_h record;

for (i = 0; i < size; ++i)
{
	// Getting the current record
	context_history_list_get_current(list, &record);

	// Retrieving the application ID and the total used count from the record
	context_history_record_get_string(record, CONTEXT_HISTORY_APP_ID, &app_id);
	context_history_record_get_int(record, CONTEXT_HISTORY_TOTAL_COUNT, &count);

	// ...

	// Freeing the application ID string
	free(app_id);

	// Releasing the memory occupied by the record
	context_history_record_destroy(record);

	// Iterating to the next record
	context_history_list_move_next(list);
}
</pre>
				<li>After the enumeration, the list needs to be released to prevent any resource leaks.
<pre class="prettyprint">
context_history_list_destroy(list);
</pre>
				</li>
				<li>Finally, the <span style="font-family: Courier New,Courier,monospace;">handle</span> should be released,
					if it will not be used anymore.
<pre class="prettyprint">
context_history_destroy(handle);
</pre>
				</li>
			</ol>
		</div>
	</li>

</ul>

</div>
</div>

<script type="text/javascript" src="../../scripts/jquery.zclip.min.js"></script>
<script type="text/javascript" src="../../scripts/showhide.js"></script>

</div></div></div>

<a class="top sms" href="#"><img src="../../images/btn_top.gif" alt="Go to top" /></a>

<div id="footer">
<p class="footer">Except as noted, this content - excluding the Code Examples - is licensed under <a href="http://creativecommons.org/licenses/by/3.0/legalcode" target="_blank">Creative Commons Attribution 3.0</a> and all of the Code Examples contained herein are licensed under <a href="https://www.tizen.org/bsd-3-clause-license" target="_blank">BSD-3-Clause</a>.<br/>For details, see the <a href="https://www.tizen.org/content-license" target="_blank">Content License</a>.</p>
</div>

<script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-25976949-1']);
_gaq.push(['_trackPageview']);
(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script>

</body>
</html>
